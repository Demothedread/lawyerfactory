<!--
LawyerFactory Soviet Control Panel Interface
Industrial control board aesthetic with 3-panel layout for legal workflow automation
Optimized for 1920x1080 displays with collapsible panels for focus mode
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‚öôÔ∏è LawyerFactory Control Station</title>

    <!-- Core Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <!-- React and Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- ag-Grid for Evidence Management -->
    <script src="https://unpkg.com/ag-grid-community@30.2.1/dist/ag-grid-community.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/ag-grid-community@30.2.1/dist/ag-grid-theme-quartz.min.css" />

    <!-- Soviet Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;500;700;900&family=Russo+One&display=swap"
      rel="stylesheet" />

    <style>
      :root {
        /* Soviet Control Board Color Palette */
        --soviet-brass: #b87333;
        --soviet-bronze: #cd7f32;
        --soviet-emerald: #00563f;
        --soviet-crimson: #dc143c;
        --soviet-silver: #c0c0c0;
        --soviet-charcoal: #1a1a1a;
        --soviet-steel: #434b4d;
        --soviet-amber: #ffb000;
        --soviet-warning: #ff6b35;
        --soviet-success: #00a878;
        --panel-rivets: #8b8680;

        /* Panel Dimensions */
        --panel-left: 400px;
        --panel-center: 920px;
        --panel-right: 600px;
        --panel-header: 80px;
        --panel-collapsed: 48px;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Share Tech Mono", "Russo One", monospace;
        background: linear-gradient(
          135deg,
          var(--soviet-charcoal) 0%,
          var(--soviet-steel) 100%
        );
        color: var(--soviet-silver);
        overflow: hidden;
        position: relative;
      }

      /* Scanline Effect */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: repeating-linear-gradient(
          0deg,
          transparent,
          transparent 2px,
          rgba(0, 0, 0, 0.03) 2px,
          rgba(0, 0, 0, 0.03) 4px
        );
        pointer-events: none;
        z-index: 9999;
      }

      /* Main Control Panel Container */
      .control-station {
        display: flex;
        height: 100vh;
        position: relative;
        background: radial-gradient(
          ellipse at center,
          rgba(184, 115, 51, 0.05) 0%,
          transparent 70%
        );
      }

      /* Metal Panel Base Style */
      .metal-panel {
        background: linear-gradient(
          135deg,
          #2a2a2a 0%,
          #1f1f1f 50%,
          #2a2a2a 100%
        );
        border: 3px solid var(--soviet-brass);
        position: relative;
        box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5),
          inset 0 -2px 5px rgba(0, 0, 0, 0.5), 0 4px 8px rgba(0, 0, 0, 0.8);
      }

      /* Rivet Decoration */
      .rivets::before,
      .rivets::after {
        content: "‚¨¢ ‚¨¢ ‚¨¢ ‚¨¢";
        position: absolute;
        color: var(--panel-rivets);
        font-size: 10px;
        letter-spacing: 20px;
        left: 10px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      }

      .rivets::before {
        top: 8px;
      }

      .rivets::after {
        bottom: 8px;
      }

      /* Panel Headers */
      .panel-header {
        height: var(--panel-header);
        background: linear-gradient(
          180deg,
          var(--soviet-brass) 0%,
          var(--soviet-bronze) 100%
        );
        border-bottom: 3px solid var(--soviet-charcoal);
        display: flex;
        align-items: center;
        padding: 0 20px;
        position: relative;
        font-family: "Orbitron", monospace;
        font-weight: 700;
        color: var(--soviet-charcoal);
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      /* Warning Stripes */
      .warning-stripe {
        height: 8px;
        background: repeating-linear-gradient(
          45deg,
          var(--soviet-amber),
          var(--soviet-amber) 10px,
          var(--soviet-charcoal) 10px,
          var(--soviet-charcoal) 20px
        );
      }

      /* Analog Gauge Component */
      .analog-gauge {
        width: 120px;
        height: 120px;
        position: relative;
        background: radial-gradient(circle at center, #1a1a1a 0%, #0f0f0f 100%);
        border: 3px solid var(--soviet-brass);
        border-radius: 50%;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8),
          0 2px 10px rgba(0, 0, 0, 0.5);
      }

      .gauge-needle {
        position: absolute;
        width: 2px;
        height: 45px;
        background: var(--soviet-crimson);
        left: 50%;
        top: 15%;
        transform-origin: center bottom;
        transform: translateX(-50%) rotate(0deg);
        transition: transform 0.3s ease-out;
        box-shadow: 0 0 4px var(--soviet-crimson);
      }

      .gauge-center {
        position: absolute;
        width: 20px;
        height: 20px;
        background: var(--soviet-brass);
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
      }

      /* Toggle Switch Component */
      .toggle-switch {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 8px;
        background: var(--soviet-charcoal);
        border: 2px solid var(--soviet-brass);
        border-radius: 4px;
      }

      .toggle-track {
        width: 60px;
        height: 30px;
        background: linear-gradient(180deg, #0f0f0f 0%, #2a2a2a 100%);
        border-radius: 15px;
        position: relative;
        cursor: pointer;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.8);
      }

      .toggle-handle {
        width: 26px;
        height: 26px;
        background: linear-gradient(
          135deg,
          var(--soviet-brass) 0%,
          var(--soviet-bronze) 100%
        );
        border-radius: 50%;
        position: absolute;
        top: 2px;
        left: 2px;
        transition: transform 0.2s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      .toggle-switch.active .toggle-handle {
        transform: translateX(30px);
      }

      .led-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--soviet-crimson);
        box-shadow: 0 0 8px var(--soviet-crimson);
        opacity: 0.3;
        transition: opacity 0.2s ease;
      }

      .toggle-switch.active .led-indicator {
        background: var(--soviet-success);
        box-shadow: 0 0 12px var(--soviet-success);
        opacity: 1;
      }

      /* Nixie Tube Display */
      .nixie-display {
        display: inline-block;
        padding: 10px 15px;
        background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
        border: 2px solid var(--soviet-brass);
        border-radius: 6px;
        font-family: "Orbitron", monospace;
        font-size: 28px;
        font-weight: 900;
        color: var(--soviet-amber);
        text-shadow: 0 0 10px var(--soviet-amber);
        box-shadow: inset 0 0 20px rgba(255, 176, 0, 0.2),
          0 2px 10px rgba(0, 0, 0, 0.8);
      }

      /* Mechanical Button */
      .mech-button {
        display: inline-block;
        padding: 12px 24px;
        background: linear-gradient(
          135deg,
          var(--soviet-brass) 0%,
          var(--soviet-bronze) 50%,
          var(--soviet-brass) 100%
        );
        border: 3px solid var(--soviet-charcoal);
        border-radius: 6px;
        font-family: "Russo One", sans-serif;
        font-size: 14px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--soviet-charcoal);
        cursor: pointer;
        position: relative;
        transition: all 0.1s ease;
        box-shadow: 0 4px 0 var(--soviet-charcoal), 0 6px 8px rgba(0, 0, 0, 0.5);
      }

      .mech-button:active {
        transform: translateY(4px);
        box-shadow: 0 0 0 var(--soviet-charcoal), 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      .mech-button.danger {
        background: linear-gradient(
          135deg,
          var(--soviet-crimson) 0%,
          #b91c1c 50%,
          var(--soviet-crimson) 100%
        );
        color: white;
      }

      .mech-button.success {
        background: linear-gradient(
          135deg,
          var(--soviet-emerald) 0%,
          #00a878 50%,
          var(--soviet-emerald) 100%
        );
        color: white;
      }

      /* Status Light Array */
      .status-lights {
        display: flex;
        gap: 8px;
        padding: 10px;
        background: var(--soviet-charcoal);
        border: 2px solid var(--soviet-steel);
        border-radius: 4px;
      }

      .status-light {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: var(--soviet-steel);
        position: relative;
        transition: all 0.3s ease;
      }

      .status-light.green {
        background: var(--soviet-success);
        box-shadow: 0 0 10px var(--soviet-success);
      }

      .status-light.amber {
        background: var(--soviet-amber);
        box-shadow: 0 0 10px var(--soviet-amber);
        animation: pulse 1s infinite;
      }

      .status-light.red {
        background: var(--soviet-crimson);
        box-shadow: 0 0 10px var(--soviet-crimson);
        animation: blink 0.5s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      @keyframes blink {
        0%,
        50%,
        100% {
          opacity: 1;
        }
        25%,
        75% {
          opacity: 0.3;
        }
      }

      /* Panel Layouts */
      .panel-left {
        width: var(--panel-left);
        transition: width 0.3s ease;
        border-right: 3px solid var(--soviet-brass);
      }

      .panel-center {
        flex: 1;
        min-width: var(--panel-center);
      }

      .panel-right {
        width: var(--panel-right);
        transition: width 0.3s ease;
        border-left: 3px solid var(--soviet-brass);
      }

      .panel-collapsed {
        width: var(--panel-collapsed) !important;
      }

      .panel-content {
        padding: 20px;
        height: calc(100vh - var(--panel-header));
        overflow-y: auto;
      }

      /* Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 12px;
      }

      ::-webkit-scrollbar-track {
        background: var(--soviet-charcoal);
        border: 1px solid var(--soviet-steel);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--soviet-brass);
        border-radius: 2px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--soviet-bronze);
      }

      /* Soviet Grid Theme Override */
      .ag-theme-soviet {
        --ag-background-color: var(--soviet-charcoal);
        --ag-header-background-color: var(--soviet-steel);
        --ag-header-foreground-color: var(--soviet-silver);
        --ag-border-color: var(--soviet-brass);
        --ag-row-hover-color: rgba(184, 115, 51, 0.1);
        --ag-selected-row-background-color: rgba(0, 86, 63, 0.2);
      }

      /* Chat Interface */
      .chat-container {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .chat-message {
        display: flex;
        gap: 12px;
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .agent-avatar {
        width: 48px;
        height: 48px;
        background: var(--soviet-brass);
        border: 2px solid var(--soviet-charcoal);
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        flex-shrink: 0;
      }

      .message-content {
        flex: 1;
        padding: 12px;
        background: rgba(43, 75, 77, 0.3);
        border: 1px solid var(--soviet-steel);
        border-radius: 6px;
        font-family: "Share Tech Mono", monospace;
        font-size: 14px;
        line-height: 1.6;
      }

      .chat-input {
        padding: 20px;
        border-top: 2px solid var(--soviet-brass);
        background: var(--soviet-charcoal);
      }

      .input-field {
        width: 100%;
        padding: 12px;
        background: var(--soviet-steel);
        border: 2px solid var(--soviet-brass);
        border-radius: 4px;
        color: var(--soviet-silver);
        font-family: "Share Tech Mono", monospace;
        font-size: 14px;
      }

      .input-field:focus {
        outline: none;
        border-color: var(--soviet-amber);
        box-shadow: 0 0 10px rgba(255, 176, 0, 0.3);
      }

      /* Phase Interface Styling */
      .phase-interface {
        background: var(--soviet-charcoal);
        border: 3px solid var(--soviet-brass);
        border-radius: 8px;
        box-shadow: inset 0 0 20px rgba(184, 115, 51, 0.2),
          0 0 30px rgba(184, 115, 51, 0.3);
        animation: panelGlow 3s ease-in-out infinite alternate;
        min-height: calc(100vh - 40px);
        overflow-y: auto;
      }

      .phase-interface .panel-title {
        background: linear-gradient(
          90deg,
          var(--soviet-brass),
          var(--soviet-bronze)
        );
        color: var(--soviet-charcoal);
        padding: 15px 20px;
        font-family: "Orbitron", monospace;
        font-weight: 700;
        font-size: 18px;
        border-bottom: 2px solid var(--soviet-brass);
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .upload-zone {
        border: 3px dashed var(--soviet-brass);
        border-radius: 12px;
        padding: 40px;
        text-align: center;
        background: rgba(184, 115, 51, 0.05);
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .upload-zone:hover {
        border-color: var(--soviet-amber);
        background: rgba(255, 176, 0, 0.1);
      }

      .upload-zone.dragging {
        border-color: var(--soviet-amber);
        background: rgba(255, 176, 0, 0.15);
        transform: scale(1.02);
      }

      .file-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background: rgba(184, 115, 51, 0.05);
        border-radius: 8px;
        margin-bottom: 8px;
        border: 1px solid var(--soviet-brass);
        transition: all 0.3s ease;
      }

      .file-item:hover {
        background: rgba(184, 115, 51, 0.1);
        border-color: var(--soviet-amber);
      }

      .research-query {
        width: 100%;
        padding: 12px;
        border: 2px solid var(--soviet-brass);
        border-radius: 8px;
        background: rgba(184, 115, 51, 0.05);
        color: var(--soviet-charcoal);
        font-family: "Share Tech Mono", monospace;
        font-size: 14px;
        resize: vertical;
        transition: all 0.3s ease;
      }

      .research-query:focus {
        outline: none;
        border-color: var(--soviet-amber);
        box-shadow: 0 0 10px rgba(255, 176, 0, 0.3);
      }

      .research-result {
        padding: 16px;
        background: rgba(184, 115, 51, 0.05);
        border-radius: 8px;
        margin-bottom: 12px;
        border: 1px solid var(--soviet-brass);
        transition: all 0.3s ease;
      }

      .research-result:hover {
        background: rgba(184, 115, 51, 0.1);
        border-color: var(--soviet-amber);
      }

      .authority-badge {
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 12px;
        color: white;
        font-weight: bold;
      }

      .authority-binding {
        background: var(--soviet-success);
      }

      .authority-persuasive {
        background: var(--soviet-amber);
      }

      .authority-secondary {
        background: var(--soviet-steel);
      }

      .progress-bar {
        height: 8px;
        background: rgba(184, 115, 51, 0.2);
        border-radius: 4px;
        overflow: hidden;
        position: relative;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--soviet-amber),
          var(--soviet-brass)
        );
        border-radius: 4px;
        transition: width 0.3s ease;
        position: relative;
      }

      .progress-fill::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }
    </style>
  </head>

  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef, useCallback } = React;

      // Phase Configuration
      const PHASES = [
        {
          id: "A01",
          name: "Document Intake",
          description: "Upload and categorize legal documents",
          type: "preproduction",
          icon: "üìÑ",
          inputs: ["Legal documents", "Client information", "Case details"],
          outputs: [
            "Categorized documents",
            "Extracted facts",
            "Evidence table",
          ],
        },
        {
          id: "A02",
          name: "Legal Research",
          description: "Automated legal research and authority gathering",
          type: "preproduction",
          icon: "üîç",
          inputs: ["Case facts", "Jurisdiction", "Legal issues"],
          outputs: ["Legal authorities", "Precedent cases", "Research notes"],
        },
        {
          id: "A03",
          name: "Case Outline",
          description: "Structure case claims and arguments",
          type: "preproduction",
          icon: "üìã",
          inputs: ["Research results", "Evidence", "Legal theories"],
          outputs: ["Case outline", "Claims matrix", "Argument structure"],
        },
        {
          id: "B01",
          name: "Quality Review",
          description: "Validate research and outline quality",
          type: "production",
          icon: "‚úÖ",
          inputs: ["Case outline", "Research quality", "Evidence strength"],
          outputs: [
            "Quality assessment",
            "Missing elements",
            "Recommendations",
          ],
        },
        {
          id: "B02",
          name: "Document Drafting",
          description: "Generate professional legal documents",
          type: "production",
          icon: "‚úçÔ∏è",
          inputs: ["Approved outline", "Templates", "Legal standards"],
          outputs: ["Draft documents", "Legal pleadings", "Supporting briefs"],
        },
        {
          id: "C01",
          name: "Document Editing",
          description: "Refine formatting and citations",
          type: "production",
          icon: "üîß",
          inputs: ["Draft documents", "Citation rules", "Format standards"],
          outputs: ["Formatted documents", "Proper citations", "Final review"],
        },
        {
          id: "C02",
          name: "Final Orchestration",
          description: "Coordinate and finalize all deliverables",
          type: "production",
          icon: "üéØ",
          inputs: ["All phase outputs", "Quality checks", "Client review"],
          outputs: ["Court-ready documents", "Filing package", "Case summary"],
        },
      ];

      // Soviet Control Panel Components
      const AnalogGauge = ({
        value,
        label,
        max = 100,
        color = "var(--soviet-crimson)",
      }) => {
        const angle = (value / max) * 180 - 90; // -90 to 90 degrees

        return React.createElement(
          "div",
          { className: "analog-gauge" },
          React.createElement("div", {
            className: "gauge-needle",
            style: { transform: `translateX(-50%) rotate(${angle}deg)` },
          }),
          React.createElement("div", { className: "gauge-center" }),
          React.createElement(
            "div",
            {
              style: {
                position: "absolute",
                bottom: "15px",
                left: "50%",
                transform: "translateX(-50%)",
                fontSize: "12px",
                fontWeight: "bold",
                color: "var(--soviet-silver)",
              },
            },
            label
          )
        );
      };

      const ToggleSwitch = ({ active, onToggle, label }) => {
        return React.createElement(
          "div",
          { className: "toggle-switch" + (active ? " active" : "") },
          React.createElement(
            "span",
            { style: { fontSize: "12px", color: "var(--soviet-silver)" } },
            label
          ),
          React.createElement(
            "div",
            { className: "toggle-track", onClick: onToggle },
            React.createElement("div", { className: "toggle-handle" })
          ),
          React.createElement("div", { className: "led-indicator" })
        );
      };

      const NixieDisplay = ({ value, digits = 3 }) => {
        const paddedValue = String(value).padStart(digits, "0");
        return React.createElement(
          "div",
          { className: "nixie-display" },
          paddedValue
        );
      };

      const MetalPanel = ({
        children,
        title,
        className = "",
        collapsed = false,
      }) => {
        return React.createElement(
          "div",
          {
            className: `metal-panel rivets ${className}`,
          },
          title &&
            React.createElement(
              "div",
              { className: "panel-header" },
              React.createElement("h3", null, title)
            ),
          !collapsed &&
            React.createElement("div", { className: "panel-content" }, children)
        );
      };

      const MechanicalButton = ({
        children,
        onClick,
        variant = "default",
        disabled = false,
      }) => {
        const className = `mech-button ${variant}`;
        return React.createElement(
          "button",
          {
            className,
            onClick,
            disabled,
          },
          children
        );
      };

      const StatusLights = ({ statuses }) => {
        return React.createElement(
          "div",
          { className: "status-lights" },
          statuses.map((status, index) =>
            React.createElement("div", {
              key: index,
              className: `status-light ${status}`,
            })
          )
        );
      };

      // Legal Intake Form Component
      const LegalIntakeForm = ({ onSubmit, onCancel }) => {
        const [formData, setFormData] = useState({
          user_name: "",
          user_address: "",
          other_party_name: "",
          other_party_address: "",
          party_role: "",
          event_location: "",
          event_date: "",
          agreement_type: "",
          evidence_upload: false,
          witnesses: false,
          rough_draft: false,
          claim_description: "",
          selected_causes: [],
          jurisdiction: "",
          venue: "",
          case_type: "",
          amount_in_controversy: 0.0,
        });

        const commonCauses = [
          "Breach of Contract",
          "Negligence",
          "Products Liability",
          "Motor Vehicle Accident",
          "Landlord/Tenant Dispute",
          "Property Damage",
          "Fraud/Misrepresentation",
          "Intentional Tort",
          "Employment Dispute",
          "Consumer Protection",
          "Professional Malpractice",
          "Construction Defect",
          "Insurance Bad Faith",
          "Civil Rights Violation",
          "Other",
        ];

        const handleInputChange = (field, value) => {
          setFormData((prev) => ({
            ...prev,
            [field]: value,
          }));
        };

        const handleCauseToggle = (cause) => {
          setFormData((prev) => ({
            ...prev,
            selected_causes: prev.selected_causes.includes(cause)
              ? prev.selected_causes.filter((c) => c !== cause)
              : [...prev.selected_causes, cause],
          }));
        };

        const handleSubmit = (e) => {
          e.preventDefault();

          // Basic validation
          if (
            !formData.user_name ||
            !formData.other_party_name ||
            !formData.party_role ||
            !formData.event_location ||
            !formData.claim_description ||
            formData.selected_causes.length === 0
          ) {
            alert(
              "Please fill in all required fields and select at least one cause of action."
            );
            return;
          }

          onSubmit(formData);
        };

        return React.createElement(
          "div",
          {
            style: {
              position: "fixed",
              top: 0,
              left: 0,
              width: "100%",
              height: "100%",
              backgroundColor: "rgba(0, 0, 0, 0.8)",
              zIndex: 10000,
              display: "flex",
              alignItems: "center",
              justifyContent: "center",
              animation: "fadeIn 0.3s ease",
            },
          },
          React.createElement(
            "div",
            {
              style: {
                backgroundColor: "#ffff9f",
                width: "90%",
                maxWidth: "800px",
                maxHeight: "90vh",
                overflowY: "auto",
                borderRadius: "8px",
                boxShadow: "0 10px 30px rgba(0, 0, 0, 0.5)",
                position: "relative",
              },
            },
            // Header
            React.createElement(
              "div",
              {
                style: {
                  background: "linear-gradient(145deg, #e6e6a0, #ffff9f)",
                  padding: "20px",
                  borderBottom: "2px solid #ccc",
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "space-between",
                  position: "relative",
                },
              },
              React.createElement(
                "h2",
                {
                  style: {
                    color: "#333",
                    margin: 0,
                    fontFamily: "'Courier New', monospace",
                    fontWeight: "bold",
                    fontSize: "1.5em",
                    textShadow: "1px 1px 2px rgba(0, 0, 0, 0.1)",
                  },
                },
                "LEGAL INTAKE FORM"
              ),
              React.createElement(
                "button",
                {
                  onClick: onCancel,
                  style: {
                    background: "none",
                    border: "none",
                    fontSize: "2em",
                    cursor: "pointer",
                    color: "#666",
                    padding: 0,
                    width: "40px",
                    height: "40px",
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "center",
                    borderRadius: "50%",
                  },
                },
                "√ó"
              )
            ),
            // Form Content
            React.createElement(
              "form",
              {
                onSubmit: handleSubmit,
                style: { padding: "20px" },
              },
              // Client Information
              React.createElement(
                "div",
                { style: { marginBottom: "20px" } },
                React.createElement(
                  "h3",
                  { style: { color: "#333", marginBottom: "15px" } },
                  "üìã Client Information"
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Your Name: *"
                  ),
                  React.createElement("input", {
                    type: "text",
                    value: formData.user_name,
                    onChange: (e) =>
                      handleInputChange("user_name", e.target.value),
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                    },
                    required: true,
                  })
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Your Address:"
                  ),
                  React.createElement("textarea", {
                    value: formData.user_address,
                    onChange: (e) =>
                      handleInputChange("user_address", e.target.value),
                    rows: 2,
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                      resize: "vertical",
                    },
                  })
                )
              ),
              // Other Party Information
              React.createElement(
                "div",
                { style: { marginBottom: "20px" } },
                React.createElement(
                  "h3",
                  { style: { color: "#333", marginBottom: "15px" } },
                  "‚öñÔ∏è Other Party Information"
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Other Party Name: *"
                  ),
                  React.createElement("input", {
                    type: "text",
                    value: formData.other_party_name,
                    onChange: (e) =>
                      handleInputChange("other_party_name", e.target.value),
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                    },
                    required: true,
                  })
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Other Party Address:"
                  ),
                  React.createElement("textarea", {
                    value: formData.other_party_address,
                    onChange: (e) =>
                      handleInputChange("other_party_address", e.target.value),
                    rows: 2,
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                      resize: "vertical",
                    },
                  })
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Are you the: *"
                  ),
                  React.createElement(
                    "select",
                    {
                      value: formData.party_role,
                      onChange: (e) =>
                        handleInputChange("party_role", e.target.value),
                      style: {
                        width: "100%",
                        padding: "8px",
                        border: "1px solid #ccc",
                        borderRadius: "4px",
                        backgroundColor: "#fff",
                      },
                      required: true,
                    },
                    React.createElement("option", { value: "" }, "Select..."),
                    React.createElement(
                      "option",
                      { value: "plaintiff" },
                      "Plaintiff (Suing)"
                    ),
                    React.createElement(
                      "option",
                      { value: "defendant" },
                      "Defendant (Being Sued)"
                    )
                  )
                )
              ),
              // Case Details
              React.createElement(
                "div",
                { style: { marginBottom: "20px" } },
                React.createElement(
                  "h3",
                  { style: { color: "#333", marginBottom: "15px" } },
                  "üìç Case Details"
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Where did most events occur? *"
                  ),
                  React.createElement("input", {
                    type: "text",
                    value: formData.event_location,
                    onChange: (e) =>
                      handleInputChange("event_location", e.target.value),
                    placeholder: "City, State",
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                    },
                    required: true,
                  })
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "When did most events occur?"
                  ),
                  React.createElement("input", {
                    type: "text",
                    value: formData.event_date,
                    onChange: (e) =>
                      handleInputChange("event_date", e.target.value),
                    placeholder: "Approximate date or date range",
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                    },
                  })
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Was there a written or oral agreement?"
                  ),
                  React.createElement(
                    "select",
                    {
                      value: formData.agreement_type,
                      onChange: (e) =>
                        handleInputChange("agreement_type", e.target.value),
                      style: {
                        width: "100%",
                        padding: "8px",
                        border: "1px solid #ccc",
                        borderRadius: "4px",
                        backgroundColor: "#fff",
                      },
                    },
                    React.createElement("option", { value: "" }, "Select..."),
                    React.createElement(
                      "option",
                      { value: "written" },
                      "Written Agreement"
                    ),
                    React.createElement(
                      "option",
                      { value: "oral" },
                      "Oral Agreement"
                    ),
                    React.createElement(
                      "option",
                      { value: "none" },
                      "No Agreement"
                    )
                  )
                )
              ),
              // Claim Description
              React.createElement(
                "div",
                { style: { marginBottom: "20px" } },
                React.createElement(
                  "h3",
                  { style: { color: "#333", marginBottom: "15px" } },
                  "üí∞ Claim Description"
                ),
                React.createElement(
                  "div",
                  { style: { marginBottom: "10px" } },
                  React.createElement(
                    "label",
                    {
                      style: {
                        display: "block",
                        marginBottom: "5px",
                        fontWeight: "bold",
                      },
                    },
                    "Why does the other party owe you? (Be specific) *"
                  ),
                  React.createElement("textarea", {
                    value: formData.claim_description,
                    onChange: (e) =>
                      handleInputChange("claim_description", e.target.value),
                    rows: 4,
                    placeholder:
                      "Describe what happened and why you're entitled to relief...",
                    style: {
                      width: "100%",
                      padding: "8px",
                      border: "1px solid #ccc",
                      borderRadius: "4px",
                      backgroundColor: "#fff",
                      resize: "vertical",
                    },
                    required: true,
                  })
                )
              ),
              // Cause of Action Selection
              React.createElement(
                "div",
                { style: { marginBottom: "20px" } },
                React.createElement(
                  "h3",
                  { style: { color: "#333", marginBottom: "15px" } },
                  "‚öñÔ∏è Potential Causes of Action"
                ),
                React.createElement(
                  "p",
                  { style: { marginBottom: "10px", fontStyle: "italic" } },
                  "Select all that may apply to your case: *"
                ),
                React.createElement(
                  "div",
                  {
                    style: {
                      display: "grid",
                      gridTemplateColumns:
                        "repeat(auto-fit, minmax(200px, 1fr))",
                      gap: "10px",
                    },
                  },
                  ...commonCauses.map((cause) =>
                    React.createElement(
                      "label",
                      {
                        key: cause,
                        style: {
                          display: "flex",
                          alignItems: "center",
                          cursor: "pointer",
                          padding: "8px",
                          backgroundColor: formData.selected_causes.includes(
                            cause
                          )
                            ? "#e0f0ff"
                            : "#f5f5f5",
                          borderRadius: "4px",
                          border: formData.selected_causes.includes(cause)
                            ? "2px solid #0066cc"
                            : "1px solid #ccc",
                        },
                      },
                      React.createElement("input", {
                        type: "checkbox",
                        checked: formData.selected_causes.includes(cause),
                        onChange: () => handleCauseToggle(cause),
                        style: { marginRight: "8px" },
                      }),
                      cause
                    )
                  )
                )
              ),
              // Action Buttons
              React.createElement(
                "div",
                {
                  style: {
                    display: "flex",
                    gap: "12px",
                    justifyContent: "flex-end",
                    marginTop: "20px",
                    paddingTop: "20px",
                    borderTop: "1px solid #ccc",
                  },
                },
                React.createElement(
                  MechanicalButton,
                  {
                    onClick: onCancel,
                    variant: "default",
                    type: "button",
                  },
                  "Cancel"
                ),
                React.createElement(
                  MechanicalButton,
                  {
                    variant: "success",
                    type: "submit",
                  },
                  "Create Case"
                )
              )
            )
          )
        );
      };

      // Evidence Table Component
      const EvidenceTable = () => {
        const [evidenceData, setEvidenceData] = useState([]);
        const gridRef = useRef(null);

        const columnDefs = [
          { field: "id", headerName: "ID", width: 80, pinned: "left" },
          { field: "source", headerName: "Source", width: 150 },
          { field: "content", headerName: "Content", flex: 1 },
          { field: "relevance", headerName: "Relevance", width: 100 },
          { field: "type", headerName: "Type", width: 120 },
          { field: "date", headerName: "Date", width: 100 },
        ];

        useEffect(() => {
          // Load evidence data
          fetch("/api/evidence")
            .then((response) => response.json())
            .then((data) => setEvidenceData(data.evidence_entries || []))
            .catch((error) => console.error("Error loading evidence:", error));
        }, []);

        return React.createElement(
          "div",
          {
            className: "ag-theme-soviet",
            style: { height: "400px", width: "100%" },
          },
          typeof agGrid !== "undefined" && agGrid.AgGridReact
            ? React.createElement(agGrid.AgGridReact, {
                ref: gridRef,
                columnDefs,
                rowData: evidenceData,
                defaultColDef: {
                  sortable: true,
                  filter: true,
                  resizable: true,
                },
                onGridReady: (params) => {
                  gridRef.current = params.api;
                },
              })
            : React.createElement(
                "div",
                {
                  style: {
                    padding: "20px",
                    textAlign: "center",
                    color: "var(--soviet-amber)",
                    border: "1px solid var(--soviet-brass)",
                  },
                },
                "Evidence Table Loading..."
              )
        );
      };

      // Claims Matrix Component
      const ClaimsMatrix = () => {
        const [claims, setClaims] = useState([]);

        useEffect(() => {
          // Load claims data
          fetch("/api/claims")
            .then((response) => response.json())
            .then((data) => setClaims(data.claims || []))
            .catch((error) => console.error("Error loading claims:", error));
        }, []);

        return React.createElement(
          "div",
          { className: "claims-matrix" },
          React.createElement("h4", null, "Claims Matrix"),
          React.createElement(
            "div",
            { className: "matrix-grid" },
            claims.map((claim, index) =>
              React.createElement(
                "div",
                {
                  key: index,
                  className: "claim-card metal-panel",
                  style: { margin: "10px", padding: "15px" },
                },
                React.createElement(
                  "h5",
                  null,
                  claim.cause_of_action || "Claim " + (index + 1)
                ),
                React.createElement(
                  "div",
                  { className: "claim-strength" },
                  React.createElement(AnalogGauge, {
                    value: claim.claim_strength * 100 || 0,
                    label: "Strength",
                    max: 100,
                  })
                )
              )
            )
          )
        );
      };

      // Shot List Component
      const ShotList = () => {
        const [shots, setShots] = useState([]);

        useEffect(() => {
          // Load shot list data
          fetch("/api/shotlist")
            .then((response) => response.json())
            .then((data) => setShots(data.shots || []))
            .catch((error) => console.error("Error loading shots:", error));
        }, []);

        return React.createElement(
          "div",
          { className: "shot-list" },
          React.createElement("h4", null, "Document Sequence"),
          React.createElement(
            "div",
            { className: "shot-items" },
            shots.map((shot, index) =>
              React.createElement(
                "div",
                {
                  key: index,
                  className: "shot-item",
                  style: {
                    padding: "10px",
                    margin: "5px 0",
                    background: "var(--soviet-steel)",
                    border: "1px solid var(--soviet-brass)",
                    borderRadius: "4px",
                  },
                },
                React.createElement(
                  "div",
                  { style: { fontWeight: "bold" } },
                  shot.title || `Shot ${index + 1}`
                ),
                React.createElement(
                  "div",
                  { style: { fontSize: "12px", opacity: 0.8 } },
                  shot.description || "Document preparation step"
                )
              )
            )
          )
        );
      };

      // Chat Interface Component
      const ChatInterface = () => {
        const [messages, setMessages] = useState([]);
        const [inputValue, setInputValue] = useState("");
        const [activeAgent, setActiveAgent] = useState("maestro");
        const messagesEndRef = useRef(null);

        const agents = {
          maestro: {
            name: "Maestro",
            icon: "üé≠",
            color: "var(--soviet-brass)",
          },
          reader: {
            name: "Reader",
            icon: "üìñ",
            color: "var(--soviet-emerald)",
          },
          researcher: {
            name: "Researcher",
            icon: "üîç",
            color: "var(--soviet-bronze)",
          },
          writer: { name: "Writer", icon: "‚úçÔ∏è", color: "var(--soviet-amber)" },
          editor: {
            name: "Editor",
            icon: "üîß",
            color: "var(--soviet-crimson)",
          },
        };

        const scrollToBottom = () => {
          messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
        };

        useEffect(scrollToBottom, [messages]);

        const handleSendMessage = () => {
          if (!inputValue.trim()) return;

          const newMessage = {
            id: Date.now(),
            agent: "user",
            content: inputValue,
            timestamp: new Date().toLocaleTimeString(),
          };

          setMessages((prev) => [...prev, newMessage]);
          setInputValue("");

          // Simulate agent response
          setTimeout(() => {
            const response = {
              id: Date.now() + 1,
              agent: activeAgent,
              content: `${agents[activeAgent].name} acknowledges: "${inputValue}". Processing request...`,
              timestamp: new Date().toLocaleTimeString(),
            };
            setMessages((prev) => [...prev, response]);
          }, 1000);
        };

        const handleKeyPress = (e) => {
          if (e.key === "Enter" && !e.shiftKey) {
            e.preventDefault();
            handleSendMessage();
          }
        };

        return React.createElement(
          "div",
          { className: "chat-container" },
          React.createElement(
            "div",
            { className: "chat-messages" },
            messages.map((message) =>
              React.createElement(
                "div",
                {
                  key: message.id,
                  className: "chat-message",
                },
                React.createElement(
                  "div",
                  {
                    className: "agent-avatar",
                    style: {
                      background:
                        message.agent === "user"
                          ? "var(--soviet-steel)"
                          : agents[message.agent]?.color,
                    },
                  },
                  message.agent === "user" ? "üë§" : agents[message.agent]?.icon
                ),
                React.createElement(
                  "div",
                  { className: "message-content" },
                  React.createElement(
                    "div",
                    {
                      style: {
                        fontSize: "12px",
                        opacity: 0.7,
                        marginBottom: "5px",
                      },
                    },
                    `${
                      message.agent === "user"
                        ? "You"
                        : agents[message.agent]?.name
                    } - ${message.timestamp}`
                  ),
                  message.content
                )
              )
            ),
            React.createElement("div", { ref: messagesEndRef })
          ),
          React.createElement(
            "div",
            { className: "chat-input" },
            React.createElement(
              "div",
              { style: { marginBottom: "10px" } },
              React.createElement(
                "label",
                { style: { fontSize: "12px", marginRight: "10px" } },
                "Active Agent:"
              ),
              React.createElement(
                "select",
                {
                  value: activeAgent,
                  onChange: (e) => setActiveAgent(e.target.value),
                  style: {
                    background: "var(--soviet-steel)",
                    border: "1px solid var(--soviet-brass)",
                    color: "var(--soviet-silver)",
                    padding: "5px",
                  },
                },
                Object.entries(agents).map(([key, agent]) =>
                  React.createElement(
                    "option",
                    { key, value: key },
                    `${agent.icon} ${agent.name}`
                  )
                )
              )
            ),
            React.createElement(
              "div",
              { style: { display: "flex", gap: "10px" } },
              React.createElement("input", {
                type: "text",
                className: "input-field",
                value: inputValue,
                onChange: (e) => setInputValue(e.target.value),
                onKeyPress: handleKeyPress,
                placeholder: `Message ${agents[activeAgent].name}...`,
                style: { flex: 1 },
              }),
              React.createElement(
                MechanicalButton,
                {
                  onClick: handleSendMessage,
                  variant: "success",
                },
                "Send"
              )
            )
          )
        );
      };

      // Workflow Panel Component
      const WorkflowPanel = ({ collapsed, onPhaseSelect }) => {
        const [activePhase, setActivePhase] = useState(null);
        const [completedPhases, setCompletedPhases] = useState(new Set());
        const [phaseProgress, setPhaseProgress] = useState({});

        const handlePhaseSelect = (phaseId) => {
          setActivePhase(phaseId);
          // Notify parent component to show phase interface
          onPhaseSelect(phaseId);
          // Emit to backend via Socket.IO
          socketRef.current?.emit("start_phase", { phase: phaseId });
        };

        const handlePhaseComplete = (phaseId) => {
          setCompletedPhases((prev) => new Set([...prev, phaseId]));
          setActivePhase(null);
          onPhaseSelect(null); // Close phase interface
        };

        const getPhaseStatus = (phase) => {
          if (completedPhases.has(phase.id)) return "completed";
          if (activePhase === phase.id) return "active";
          return "pending";
        };

        if (collapsed) {
          return React.createElement(MetalPanel, {
            title: "WF",
            collapsed: true,
            className: "panel-left panel-collapsed",
          });
        }

        return React.createElement(
          MetalPanel,
          {
            title: "Workflow Control",
            className: "panel-left",
          },
          React.createElement(
            "div",
            { style: { marginBottom: "20px" } },
            React.createElement("h4", null, "System Status"),
            React.createElement(StatusLights, {
              statuses: ["green", "green", "amber", "red", "red"],
            })
          ),

          React.createElement(
            "div",
            { style: { marginBottom: "20px" } },
            React.createElement("h4", null, "Progress Metrics"),
            React.createElement(AnalogGauge, {
              value: (completedPhases.size / PHASES.length) * 100,
              label: "Overall",
              max: 100,
            }),
            React.createElement(NixieDisplay, {
              value: completedPhases.size,
              digits: 1,
            }),
            React.createElement(
              "span",
              { style: { marginLeft: "10px", fontSize: "12px" } },
              `/ ${PHASES.length} Phases`
            )
          ),

          React.createElement(
            "div",
            { className: "workflow-phases" },
            React.createElement("h4", null, "Phase Control"),
            PHASES.map((phase) => {
              const status = getPhaseStatus(phase);
              return React.createElement(
                "div",
                {
                  key: phase.id,
                  style: {
                    margin: "10px 0",
                    padding: "10px",
                    background:
                      status === "active"
                        ? "rgba(255, 176, 0, 0.1)"
                        : status === "completed"
                        ? "rgba(0, 168, 120, 0.1)"
                        : "var(--soviet-steel)",
                    border: "1px solid var(--soviet-brass)",
                    borderRadius: "4px",
                  },
                },
                React.createElement(
                  "div",
                  {
                    style: {
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      marginBottom: "5px",
                    },
                  },
                  React.createElement(
                    "span",
                    { style: { fontWeight: "bold" } },
                    `${phase.icon} ${phase.id}`
                  ),
                  React.createElement("div", {
                    className: `status-light ${
                      status === "completed"
                        ? "green"
                        : status === "active"
                        ? "amber"
                        : ""
                    }`,
                  })
                ),
                React.createElement(
                  "div",
                  { style: { fontSize: "12px", marginBottom: "5px" } },
                  phase.name
                ),
                status === "pending" &&
                  React.createElement(
                    MechanicalButton,
                    {
                      onClick: () => handlePhaseSelect(phase.id),
                      variant: "default",
                    },
                    "Open"
                  ),
                status === "active" &&
                  React.createElement(
                    MechanicalButton,
                    {
                      onClick: () => handlePhaseComplete(phase.id),
                      variant: "success",
                    },
                    "Complete"
                  )
              );
            })
          )
        );
      };

      // Phase-Specific Interface Components
      const PhaseInterface = ({ phase, onComplete, onCancel }) => {
        if (!phase) return null;

        const phaseComponents = {
          A01: IntakePhaseInterface,
          A02: ResearchPhaseInterface,
          A03: OutlinePhaseInterface,
          B01: ReviewPhaseInterface,
          B02: DraftingPhaseInterface,
          C01: EditingPhaseInterface,
          C02: OrchestrationPhaseInterface,
        };

        const PhaseComponent = phaseComponents[phase] || DefaultPhaseInterface;

        return React.createElement(PhaseComponent, {
          phase,
          onComplete,
          onCancel,
        });
      };

      // A01 Intake Phase - Legal Intake Form & Case Creation
      const IntakePhaseInterface = ({ onComplete, onCancel }) => {
        const [currentCase, setCurrentCase] = useState(null);
        const [showIntakeForm, setShowIntakeForm] = useState(false);
        const [uploadedFiles, setUploadedFiles] = useState([]);
        const [isDragging, setIsDragging] = useState(false);
        const [intakeCompleted, setIntakeCompleted] = useState(false);
        const fileInputRef = useRef(null);

        // Check if intake has been completed
        useEffect(() => {
          const completed = localStorage.getItem("intake_completed");
          if (completed) {
            const caseData = JSON.parse(
              localStorage.getItem("current_case") || "{}"
            );
            setCurrentCase(caseData);
            setIntakeCompleted(true);
          } else {
            // Show intake form by default if not completed
            setShowIntakeForm(true);
          }
        }, []);

        const handleIntakeSubmission = async (formData) => {
          try {
            const response = await fetch("/api/intake", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formData),
            });

            const result = await response.json();

            if (result.success) {
              // Store case data
              setCurrentCase(result.case);
              localStorage.setItem("current_case", JSON.stringify(result.case));
              localStorage.setItem("intake_completed", "true");
              setIntakeCompleted(true);
              setShowIntakeForm(false);

              // Emit progress update
              socketRef.current?.emit("phase_progress_update", {
                phase: "A01_Intake",
                progress: 50,
                message: "Intake form completed, case created",
              });

              console.log("Case created successfully:", result.case);
            } else {
              console.error("Intake submission failed:", result.error);
              alert("Failed to create case. Please try again.");
            }
          } catch (error) {
            console.error("Intake submission error:", error);
            alert("Error submitting intake form. Please try again.");
          }
        };

        const handleFileUpload = async (files) => {
          if (!currentCase) {
            alert(
              "Please complete the intake form first before uploading documents."
            );
            return;
          }

          const newFiles = Array.from(files).map((file) => ({
            id: Date.now() + Math.random(),
            name: file.name,
            size: file.size,
            type: file.type,
            status: "uploading",
            progress: 0,
          }));

          setUploadedFiles((prev) => [...prev, ...newFiles]);

          // Real file upload to case-specific endpoint
          try {
            const formData = new FormData();
            Array.from(files).forEach((file) => {
              formData.append("files", file);
            });

            // Start upload progress simulation while uploading
            const progressInterval = setInterval(() => {
              setUploadedFiles((prev) =>
                prev.map((f) => {
                  if (
                    newFiles.some((nf) => nf.id === f.id) &&
                    f.status === "uploading"
                  ) {
                    return { ...f, progress: Math.min(90, f.progress + 15) };
                  }
                  return f;
                })
              );
            }, 500);

            const response = await fetch(
              `/api/cases/${currentCase.case_id}/documents`,
              {
                method: "POST",
                body: formData,
              }
            );

            clearInterval(progressInterval);

            const result = await response.json();

            if (result.success) {
              // Update files with real backend data
              setUploadedFiles((prev) =>
                prev.map((f) => {
                  const backendFile = result.uploaded_files.find(
                    (bf) => bf.filename === f.name
                  );
                  if (backendFile) {
                    return {
                      ...f,
                      id: backendFile.id,
                      status: "completed",
                      progress: 100,
                      document_category: backendFile.document_category,
                      authority_level: backendFile.authority_level,
                      intake_processed: backendFile.intake_processed,
                      file_path: backendFile.file_path,
                    };
                  }
                  return { ...f, status: "completed", progress: 100 };
                })
              );

              // Show success notification
              console.log(
                `Successfully uploaded ${result.total} files to case ${currentCase.case_id}`
              );

              // Update phase progress if provided
              if (result.phase_progress) {
                // Emit phase progress update
                socketRef.current?.emit("phase_progress_update", {
                  phase: "A01_Intake",
                  progress: result.phase_progress,
                  message: `Uploaded ${result.total} documents`,
                });
              }
            } else {
              // Handle upload failure
              setUploadedFiles((prev) =>
                prev.map((f) => {
                  if (newFiles.some((nf) => nf.id === f.id)) {
                    return {
                      ...f,
                      status: "error",
                      progress: 0,
                      error: result.error,
                    };
                  }
                  return f;
                })
              );
              console.error("Upload failed:", result.error);
            }
          } catch (error) {
            console.error("Upload error:", error);
            setUploadedFiles((prev) =>
              prev.map((f) => {
                if (newFiles.some((nf) => nf.id === f.id)) {
                  return {
                    ...f,
                    status: "error",
                    progress: 0,
                    error: error.message,
                  };
                }
                return f;
              })
            );
          }
        };

        const handleDrop = (e) => {
          e.preventDefault();
          setIsDragging(false);
          const files = e.dataTransfer.files;
          handleFileUpload(files);
        };

        const handleDragOver = (e) => {
          e.preventDefault();
          setIsDragging(true);
        };

        const handleDragLeave = (e) => {
          e.preventDefault();
          setIsDragging(false);
        };

        return React.createElement(
          MetalPanel,
          {
            title: "üóÇÔ∏è A01: Legal Intake & Case Creation",
            className: "phase-interface",
          },
          React.createElement(
            "div",
            { style: { padding: "20px" } },

            // Show intake form if not completed
            !intakeCompleted && React.createElement(LegalIntakeForm, {
              onSubmit: handleIntakeSubmission,
              onCancel: () => setShowIntakeForm(false)
            }),

            // Show case info and upload area if intake completed
            intakeCompleted && React.createElement(
              "div",
              {},
              // Case Information
              React.createElement(
                "div",
                {
                  style: {
                    backgroundColor: "rgba(0, 166, 120, 0.1)",
                    border: "2px solid var(--soviet-success)",
                    borderRadius: "8px",
                    padding: "16px",
                    marginBottom: "20px",
                  }
                },
                React.createElement(
                  "h3",
                  {
                    style: { color: "var(--soviet-success)", marginBottom: "12px" }
                  },
                  "‚úÖ Case Created Successfully"
                ),
                currentCase && React.createElement(
                  "div",
                  { style: { fontSize: "14px", color: "var(--soviet-steel)" } },
                  React.createElement("div", {}, `Case ID: ${currentCase.case_id}`),
                  React.createElement("div", {}, `Parties: ${currentCase.client_name} vs ${currentCase.defendant_name}`),
                  React.createElement("div", {}, `Causes: ${currentCase.causes_of_action ? currentCase.causes_of_action.join(', ') : 'Not specified'}`)
                )
              ),

              // Upload Area
              React.createElement(
                "div",
                {
                  style: {
                    border: `3px dashed ${
                      isDragging ? "var(--soviet-amber)" : "var(--soviet-brass)"
                    }`,
                    borderRadius: "12px",
                    padding: "40px",
                    textAlign: "center",
                    backgroundColor: isDragging
                      ? "rgba(255, 176, 0, 0.1)"
                      : "rgba(184, 115, 51, 0.05)",
                    marginBottom: "20px",
                    cursor: "pointer",
                    transition: "all 0.3s ease",
                  },
                  onDrop: handleDrop,
                  onDragOver: handleDragOver,
                  onDragLeave: handleDragLeave,
                  onClick: () => fileInputRef.current?.click(),
                },
                React.createElement(
                  "div",
                  { style: { fontSize: "48px", marginBottom: "16px" } },
                  "üìÅ"
                ),
                React.createElement(
                  "h3",
                  {
                    style: { color: "var(--soviet-brass)", marginBottom: "8px" },
                  },
                  "Upload Legal Documents & Evidence"
                ),
                React.createElement(
                  "p",
                  {
                    style: { color: "var(--soviet-steel)", marginBottom: "16px" },
                  },
                  `Upload documents for case ${currentCase?.case_id || 'N/A'}. Supports PDF, DOC, TXT, and image formats.`
                ),
                React.createElement("input", {
                  ref: fileInputRef,
                  type: "file",
                  multiple: true,
                  style: { display: "none" },
                  accept: ".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png",
                  onChange: (e) => handleFileUpload(e.target.files),
                })
              ),

              // Uploaded Files List
              uploadedFiles.length > 0 &&
                onChange: (e) => handleFileUpload(e.target.files),
              })
            ),

            // Uploaded Files List
            uploadedFiles.length > 0 &&
              React.createElement(
                "div",
                {
                  style: { marginBottom: "20px" },
                },
                React.createElement(
                  "h4",
                  {
                    style: {
                      color: "var(--soviet-brass)",
                      marginBottom: "16px",
                    },
                  },
                  "Uploaded Documents"
                ),
                ...uploadedFiles.map((file) =>
                  React.createElement(
                    "div",
                    {
                      key: file.id,
                      style: {
                        display: "flex",
                        alignItems: "center",
                        padding: "12px",
                        backgroundColor: "rgba(184, 115, 51, 0.05)",
                        borderRadius: "8px",
                        marginBottom: "8px",
                        border: "1px solid var(--soviet-brass)",
                      },
                    },
                    React.createElement(
                      "div",
                      {
                        style: {
                          fontSize: "20px",
                          marginRight: "12px",
                        },
                      },
                      "üìÑ"
                    ),
                    React.createElement(
                      "div",
                      { style: { flex: 1 } },
                      React.createElement(
                        "div",
                        {
                          style: {
                            fontWeight: "bold",
                            color: "var(--soviet-charcoal)",
                          },
                        },
                        file.name
                      ),
                      React.createElement(
                        "div",
                        {
                          style: {
                            fontSize: "12px",
                            color: "var(--soviet-steel)",
                            marginBottom: "4px",
                          },
                        },
                        `${(file.size / 1024 / 1024).toFixed(2)} MB`
                      ),
                      // Document Category Badge
                      file.document_category &&
                        file.document_category !== "UNKNOWN" &&
                        React.createElement(
                          "div",
                          {
                            style: {
                              fontSize: "10px",
                              padding: "2px 6px",
                              backgroundColor: "var(--soviet-amber)",
                              color: "var(--soviet-charcoal)",
                              borderRadius: "4px",
                              display: "inline-block",
                              marginRight: "8px",
                              marginTop: "2px",
                            },
                          },
                          file.document_category.replace(/_/g, " ")
                        ),
                      // Authority Level Stars
                      file.authority_level > 0 &&
                        React.createElement(
                          "div",
                          {
                            style: {
                              fontSize: "10px",
                              color: "var(--soviet-amber)",
                              display: "inline-block",
                              marginTop: "2px",
                            },
                          },
                          "‚òÖ".repeat(file.authority_level) +
                            "‚òÜ".repeat(6 - file.authority_level)
                        ),
                      // Processing Status
                      file.intake_processed &&
                        React.createElement(
                          "div",
                          {
                            style: {
                              fontSize: "10px",
                              color: "var(--soviet-success)",
                              marginTop: "2px",
                            },
                          },
                          "‚úì Processed by LawyerFactory"
                        )
                    ),
                    React.createElement(
                      "div",
                      {
                        style: {
                          marginLeft: "12px",
                          color:
                            file.status === "completed"
                              ? "var(--soviet-success)"
                              : "var(--soviet-amber)",
                        },
                      },
                      file.status === "completed" ? "‚úÖ" : `${file.progress}%`
                    )
                  )
                )
              ),

            // Action Buttons
            React.createElement(
              "div",
              {
                style: {
                  display: "flex",
                  gap: "12px",
                  justifyContent: "flex-end",
                  marginTop: "20px",
                },
              },
              React.createElement(
                MechanicalButton,
                {
                  onClick: onCancel,
                  variant: "default",
                },
                "Cancel"
              ),
              intakeCompleted && React.createElement(
                MechanicalButton,
                {
                  onClick: () => {
                    localStorage.removeItem('intake_completed');
                    localStorage.removeItem('current_case');
                    setIntakeCompleted(false);
                    setCurrentCase(null);
                    setShowIntakeForm(true);
                  },
                  variant: "default",
                  style: { marginRight: "auto" }
                },
                "New Case"
              ),
              React.createElement(
                MechanicalButton,
                {
                  onClick: () => onComplete("A01"),
                  variant: "success",
                  disabled: !intakeCompleted,
                },
                intakeCompleted ? "Proceed to Research" : "Complete Intake First"
              )
            )
          )
        );
      };

      // A02 Research Phase - LLM Research Generation
      const ResearchPhaseInterface = ({ onComplete, onCancel }) => {
        const [researchQuery, setResearchQuery] = useState("");
        const [researchResults, setResearchResults] = useState([]);
        const [isResearching, setIsResearching] = useState(false);
        const [researchProgress, setResearchProgress] = useState(0);

        const handleStartResearch = async () => {
          if (!researchQuery.trim()) return;

          setIsResearching(true);
          setResearchProgress(0);
          setResearchResults([]);

          // Simulate research progress
          const progressInterval = setInterval(() => {
            setResearchProgress((prev) => Math.min(95, prev + 5));
          }, 500);

          try {
            // Call backend research API
            const response = await fetch("/api/research/generate", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                query: researchQuery,
                case_type: "product_liability",
              }),
            });

            const data = await response.json();

            clearInterval(progressInterval);
            setResearchProgress(100);

            if (data.success) {
              setResearchResults(data.research_results || []);
            } else {
              // Fallback mock data if API not implemented yet
              setResearchResults([
                {
                  id: 1,
                  title: "Tesla Product Liability Cases - Federal Circuit",
                  content:
                    "Analysis of Tesla product liability precedents in federal courts...",
                  authority_level: "Binding",
                  jurisdiction: "Federal",
                  relevance_score: 0.95,
                },
                {
                  id: 2,
                  title: "Automotive Defect Claims - State Law Analysis",
                  content:
                    "State-specific product liability claims for automotive defects...",
                  authority_level: "Persuasive",
                  jurisdiction: "State",
                  relevance_score: 0.87,
                },
              ]);
            }
          } catch (error) {
            console.error("Research API error:", error);
            // Show mock results on error
            setResearchResults([
              {
                id: 1,
                title: "Research Error - Using Mock Data",
                content:
                  "Could not connect to research API. Showing sample results.",
                authority_level: "Unknown",
                jurisdiction: "Unknown",
                relevance_score: 0.5,
              },
            ]);
          } finally {
            clearInterval(progressInterval);
            setIsResearching(false);
            setResearchProgress(100);
          }
        };

        return React.createElement(
          MetalPanel,
          {
            title: "üîç A02: Legal Research & Authority Generation",
            className: "phase-interface",
          },
          React.createElement(
            "div",
            { style: { padding: "20px" } },
            // Research Query Input
            React.createElement(
              "div",
              { style: { marginBottom: "20px" } },
              React.createElement(
                "h4",
                {
                  style: { color: "var(--soviet-brass)", marginBottom: "12px" },
                },
                "Research Query"
              ),
              React.createElement("textarea", {
                value: researchQuery,
                onChange: (e) => setResearchQuery(e.target.value),
                placeholder:
                  'Enter your legal research query (e.g., "Tesla product liability autopilot defects federal jurisdiction")',
                style: {
                  width: "100%",
                  height: "80px",
                  padding: "12px",
                  border: "2px solid var(--soviet-brass)",
                  borderRadius: "8px",
                  backgroundColor: "rgba(184, 115, 51, 0.05)",
                  color: "var(--soviet-charcoal)",
                  fontFamily: "Share Tech Mono",
                  fontSize: "14px",
                  resize: "vertical",
                },
              })
            ),

            // Research Controls
            React.createElement(
              "div",
              {
                style: {
                  display: "flex",
                  gap: "12px",
                  alignItems: "center",
                  marginBottom: "20px",
                },
              },
              React.createElement(
                MechanicalButton,
                {
                  onClick: handleStartResearch,
                  variant: isResearching ? "default" : "success",
                  disabled: isResearching || !researchQuery.trim(),
                },
                isResearching ? "Researching..." : "Start AI Research"
              ),

              isResearching &&
                React.createElement(
                  "div",
                  {
                    style: {
                      flex: 1,
                      display: "flex",
                      alignItems: "center",
                      gap: "12px",
                    },
                  },
                  React.createElement(
                    "div",
                    {
                      style: {
                        flex: 1,
                        height: "8px",
                        backgroundColor: "rgba(184, 115, 51, 0.2)",
                        borderRadius: "4px",
                        overflow: "hidden",
                      },
                    },
                    React.createElement("div", {
                      style: {
                        width: `${researchProgress}%`,
                        height: "100%",
                        backgroundColor: "var(--soviet-amber)",
                        transition: "width 0.3s ease",
                      },
                    })
                  ),
                  React.createElement(
                    "span",
                    {
                      style: { color: "var(--soviet-steel)", fontSize: "12px" },
                    },
                    `${researchProgress}%`
                  )
                )
            ),

            // Research Results
            researchResults.length > 0 &&
              React.createElement(
                "div",
                {
                  style: { marginBottom: "20px" },
                },
                React.createElement(
                  "h4",
                  {
                    style: {
                      color: "var(--soviet-brass)",
                      marginBottom: "16px",
                    },
                  },
                  `Research Results (${researchResults.length} found)`
                ),

                ...researchResults.map((result) =>
                  React.createElement(
                    "div",
                    {
                      key: result.id,
                      style: {
                        padding: "16px",
                        backgroundColor: "rgba(184, 115, 51, 0.05)",
                        borderRadius: "8px",
                        marginBottom: "12px",
                        border: "1px solid var(--soviet-brass)",
                      },
                    },
                    React.createElement(
                      "div",
                      {
                        style: {
                          display: "flex",
                          justifyContent: "space-between",
                          alignItems: "flex-start",
                          marginBottom: "8px",
                        },
                      },
                      React.createElement(
                        "h5",
                        {
                          style: {
                            color: "var(--soviet-charcoal)",
                            margin: 0,
                            fontSize: "16px",
                            fontWeight: "bold",
                          },
                        },
                        result.title
                      ),
                      React.createElement(
                        "div",
                        {
                          style: {
                            display: "flex",
                            gap: "8px",
                            alignItems: "center",
                          },
                        },
                        React.createElement(
                          "span",
                          {
                            style: {
                              fontSize: "12px",
                              padding: "4px 8px",
                              backgroundColor:
                                result.authority_level === "Binding"
                                  ? "var(--soviet-success)"
                                  : "var(--soviet-amber)",
                              color: "white",
                              borderRadius: "12px",
                            },
                          },
                          result.authority_level
                        ),
                        React.createElement(
                          "span",
                          {
                            style: {
                              fontSize: "12px",
                              color: "var(--soviet-steel)",
                            },
                          },
                          `${Math.round(result.relevance_score * 100)}%`
                        )
                      )
                    ),
                    React.createElement(
                      "p",
                      {
                        style: {
                          color: "var(--soviet-steel)",
                          margin: "8px 0 0 0",
                          fontSize: "14px",
                          lineHeight: "1.4",
                        },
                      },
                      result.content
                    ),
                    React.createElement(
                      "div",
                      {
                        style: {
                          fontSize: "12px",
                          color: "var(--soviet-amber)",
                          marginTop: "8px",
                        },
                      },
                      `Jurisdiction: ${result.jurisdiction}`
                    )
                  )
                )
              ),

            // Action Buttons
            React.createElement(
              "div",
              {
                style: {
                  display: "flex",
                  gap: "12px",
                  justifyContent: "flex-end",
                  marginTop: "20px",
                },
              },
              React.createElement(
                MechanicalButton,
                {
                  onClick: onCancel,
                  variant: "default",
                },
                "Cancel"
              ),
              React.createElement(
                MechanicalButton,
                {
                  onClick: () => onComplete("A02"),
                  variant: "success",
                  disabled: researchResults.length === 0,
                },
                "Accept Research Results"
              )
            )
          )
        );
      };

      // A03 Outline Phase - Claims Detection & Document Structure
      const OutlinePhaseInterface = ({ onComplete, onCancel }) => {
        const [caseFactsInput, setCaseFactsInput] = useState("");
        const [claimsResults, setClaimsResults] = useState([]);
        const [outlineResults, setOutlineResults] = useState([]);
        const [isGenerating, setIsGenerating] = useState(false);
        const [currentStep, setCurrentStep] = useState("input"); // input, claims, outline, complete

        const handleGenerateOutline = async () => {
          if (!caseFactsInput.trim()) {
            alert("Please enter case facts to generate outline");
            return;
          }

          setIsGenerating(true);
          setCurrentStep("claims");

          try {
            // Step 1: Detect Claims/Causes of Action
            const claimsResponse = await fetch("/api/outline/detect-claims", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                case_facts: caseFactsInput,
                jurisdiction: "federal",
              }),
            });

            if (claimsResponse.ok) {
              const claimsData = await claimsResponse.json();
              if (claimsData.success) {
                setClaimsResults(claimsData.claims || []);
                setCurrentStep("outline");

                // Step 2: Generate Document Outline
                const outlineResponse = await fetch("/api/outline/generate", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({
                    case_facts: caseFactsInput,
                    claims: claimsData.claims || [],
                    document_type: "complaint",
                  }),
                });

                if (outlineResponse.ok) {
                  const outlineData = await outlineResponse.json();
                  if (outlineData.success) {
                    setOutlineResults(outlineData.outline_sections || []);
                    setCurrentStep("complete");
                  } else {
                    throw new Error(
                      outlineData.error || "Failed to generate outline"
                    );
                  }
                } else {
                  throw new Error("Failed to generate outline");
                }
              } else {
                throw new Error(claimsData.error || "Failed to detect claims");
              }
            } else {
              throw new Error("Failed to detect claims");
            }
          } catch (error) {
            console.error("Outline generation error:", error);
            alert(`Error generating outline: ${error.message}`);
            setCurrentStep("input");
          } finally {
            setIsGenerating(false);
          }
        };

        return React.createElement(
          MetalPanel,
          {
            title: "‚öñÔ∏è A03: Legal Outline Generation",
            className: "phase-interface",
          },
          React.createElement(
            "div",
            { style: { padding: "24px" } },

            // Case Facts Input Section
            React.createElement(
              "div",
              { style: { marginBottom: "24px" } },
              React.createElement(
                "h3",
                {
                  style: { color: "var(--soviet-brass)", marginBottom: "12px" },
                },
                "üìù Case Facts Input"
              ),
              React.createElement("textarea", {
                value: caseFactsInput,
                onChange: (e) => setCaseFactsInput(e.target.value),
                placeholder:
                  "Enter the key facts of your case here. Include relevant details about parties, events, damages, and legal issues...",
                style: {
                  width: "100%",
                  height: "120px",
                  padding: "12px",
                  fontSize: "14px",
                  backgroundColor: "var(--soviet-dark)",
                  color: "var(--soviet-brass)",
                  border: "1px solid var(--soviet-steel)",
                  borderRadius: "4px",
                  resize: "vertical",
                },
                disabled: isGenerating,
              })
            ),

            // Generation Button
            !isGenerating &&
              currentStep === "input" &&
              React.createElement(
                MechanicalButton,
                {
                  onClick: handleGenerateOutline,
                  variant: "default",
                  disabled: !caseFactsInput.trim(),
                  style: { marginBottom: "24px" },
                },
                "üîç Analyze Claims & Generate Outline"
              ),

            // Progress Indicator
            isGenerating &&
              React.createElement(
                "div",
                {
                  style: {
                    marginBottom: "24px",
                    padding: "16px",
                    backgroundColor: "var(--soviet-dark)",
                    borderRadius: "4px",
                  },
                },
                React.createElement(
                  "div",
                  {
                    style: {
                      color: "var(--soviet-brass)",
                      marginBottom: "8px",
                    },
                  },
                  "‚öôÔ∏è Generating Legal Outline..."
                ),
                React.createElement(
                  "div",
                  { style: { fontSize: "14px", color: "var(--soviet-steel)" } },
                  currentStep === "claims"
                    ? "Step 1: Detecting legal claims and causes of action..."
                    : currentStep === "outline"
                    ? "Step 2: Generating document structure and outline..."
                    : "Processing..."
                )
              ),

            // Claims Results Section
            claimsResults.length > 0 &&
              React.createElement(
                "div",
                { style: { marginBottom: "24px" } },
                React.createElement(
                  "h3",
                  {
                    style: {
                      color: "var(--soviet-brass)",
                      marginBottom: "12px",
                    },
                  },
                  "‚öñÔ∏è Detected Legal Claims"
                ),
                React.createElement(
                  "div",
                  { style: { display: "grid", gap: "12px" } },
                  claimsResults.map((claim, index) =>
                    React.createElement(
                      "div",
                      {
                        key: index,
                        style: {
                          padding: "16px",
                          backgroundColor: "var(--soviet-dark)",
                          border: "1px solid var(--soviet-steel)",
                          borderRadius: "4px",
                        },
                      },
                      React.createElement(
                        "div",
                        {
                          style: {
                            fontWeight: "bold",
                            color: "var(--soviet-brass)",
                            marginBottom: "8px",
                          },
                        },
                        claim.name || claim.title || `Claim ${index + 1}`
                      ),
                      React.createElement(
                        "div",
                        {
                          style: {
                            fontSize: "14px",
                            color: "var(--soviet-steel)",
                            marginBottom: "8px",
                          },
                        },
                        claim.description ||
                          claim.summary ||
                          "Legal claim identified"
                      ),
                      claim.elements &&
                        React.createElement(
                          "div",
                          {
                            style: {
                              fontSize: "13px",
                              color: "var(--soviet-brass)",
                            },
                          },
                          "Elements: ",
                          (claim.elements || []).join(", ")
                        )
                    )
                  )
                )
              ),

            // Outline Results Section
            outlineResults.length > 0 &&
              React.createElement(
                "div",
                { style: { marginBottom: "24px" } },
                React.createElement(
                  "h3",
                  {
                    style: {
                      color: "var(--soviet-brass)",
                      marginBottom: "12px",
                    },
                  },
                  "üìã Document Outline Structure"
                ),
                React.createElement(
                  "div",
                  { style: { display: "grid", gap: "8px" } },
                  outlineResults.map((section, index) =>
                    React.createElement(
                      "div",
                      {
                        key: index,
                        style: {
                          padding: "12px",
                          backgroundColor: "var(--soviet-dark)",
                          border: "1px solid var(--soviet-steel)",
                          borderRadius: "4px",
                          marginLeft: `${(section.level || 0) * 20}px`,
                        },
                      },
                      React.createElement(
                        "div",
                        {
                          style: {
                            fontWeight: "bold",
                            color: "var(--soviet-brass)",
                            marginBottom: "4px",
                          },
                        },
                        `${section.number || index + 1}. ${
                          section.title ||
                          section.heading ||
                          `Section ${index + 1}`
                        }`
                      ),
                      section.description &&
                        React.createElement(
                          "div",
                          {
                            style: {
                              fontSize: "13px",
                              color: "var(--soviet-steel)",
                            },
                          },
                          section.description
                        )
                    )
                  )
                )
              ),

            // Action Buttons
            React.createElement(
              "div",
              {
                style: {
                  display: "flex",
                  gap: "12px",
                  justifyContent: "space-between",
                  borderTop: "1px solid var(--soviet-steel)",
                  paddingTop: "20px",
                },
              },
              React.createElement(
                MechanicalButton,
                {
                  onClick: () => onCancel(),
                  variant: "secondary",
                },
                "‚Üê Back"
              ),
              React.createElement(
                MechanicalButton,
                {
                  onClick: () => onComplete("A03"),
                  variant: "success",
                  disabled: outlineResults.length === 0,
                },
                "Accept Outline Structure"
              )
            )
          )
        );
      };

      // Default Phase Interface for phases not yet implemented
      const DefaultPhaseInterface = ({ phase, onComplete, onCancel }) => {
        return React.createElement(
          MetalPanel,
          {
            title: `üöß ${phase}: Under Development`,
            className: "phase-interface",
          },
          React.createElement(
            "div",
            { style: { padding: "40px", textAlign: "center" } },
            React.createElement(
              "div",
              { style: { fontSize: "64px", marginBottom: "20px" } },
              "üöß"
            ),
            React.createElement(
              "h3",
              {
                style: { color: "var(--soviet-brass)", marginBottom: "16px" },
              },
              "Phase Interface Coming Soon"
            ),
            React.createElement(
              "p",
              {
                style: { color: "var(--soviet-steel)", marginBottom: "30px" },
              },
              `The ${phase} phase interface is currently under development. This will provide specialized tools for this workflow stage.`
            ),
            React.createElement(
              "div",
              {
                style: {
                  display: "flex",
                  gap: "12px",
                  justifyContent: "center",
                },
              },
              React.createElement(
                MechanicalButton,
                {
                  onClick: onCancel,
                  variant: "default",
                },
                "Back to Workflow"
              ),
              React.createElement(
                MechanicalButton,
                {
                  onClick: () => onComplete(phase),
                  variant: "success",
                },
                "Mark Complete"
              )
            )
          )
        );
      };

      // Deliverables Panel Component
      const DeliverablesPanel = ({ collapsed }) => {
        const [activeTab, setActiveTab] = useState("evidence");

        if (collapsed) {
          return React.createElement(MetalPanel, {
            title: "DEL",
            collapsed: true,
            className: "panel-center panel-collapsed",
          });
        }

        return React.createElement(
          MetalPanel,
          {
            title: "Deliverables & Data",
            className: "panel-center",
          },
          React.createElement("div", { className: "warning-stripe" }),

          React.createElement(
            "div",
            { style: { display: "flex", gap: "10px", marginBottom: "20px" } },
            React.createElement(ToggleSwitch, {
              active: activeTab === "evidence",
              onToggle: () => setActiveTab("evidence"),
              label: "Evidence",
            }),
            React.createElement(ToggleSwitch, {
              active: activeTab === "claims",
              onToggle: () => setActiveTab("claims"),
              label: "Claims",
            }),
            React.createElement(ToggleSwitch, {
              active: activeTab === "sequence",
              onToggle: () => setActiveTab("sequence"),
              label: "Sequence",
            })
          ),

          activeTab === "evidence" && React.createElement(EvidenceTable),
          activeTab === "claims" && React.createElement(ClaimsMatrix),
          activeTab === "sequence" && React.createElement(ShotList)
        );
      };

      // LLM Chat Panel Component
      const LLMChatPanel = ({ collapsed }) => {
        if (collapsed) {
          return React.createElement(MetalPanel, {
            title: "LLM",
            collapsed: true,
            className: "panel-right panel-collapsed",
          });
        }

        return React.createElement(
          MetalPanel,
          {
            title: "Agent Communication",
            className: "panel-right",
          },
          React.createElement(ChatInterface)
        );
      };

      // Main Application Component
      const LawyerFactoryApp = () => {
        const [leftCollapsed, setLeftCollapsed] = useState(false);
        const [rightCollapsed, setRightCollapsed] = useState(false);
        const [notifications, setNotifications] = useState([]);
        const [activePhase, setActivePhase] = useState(null);

        // Phase selection handler
        const handlePhaseSelect = (phaseId) => {
          setActivePhase(phaseId);
        };

        const handlePhaseComplete = (phaseId) => {
          setActivePhase(null);
          addNotification({
            type: "success",
            title: "Phase Completed",
            message: `Phase ${phaseId} has been completed successfully`,
          });
        };

        const handlePhaseCancel = () => {
          setActivePhase(null);
        };

        // Keyboard shortcuts
        useEffect(() => {
          const handleKeyPress = (e) => {
            if (e.key === "F1") {
              e.preventDefault();
              setLeftCollapsed((prev) => !prev);
            } else if (e.key === "F3") {
              e.preventDefault();
              setRightCollapsed((prev) => !prev);
            }
          };

          window.addEventListener("keydown", handleKeyPress);
          return () => window.removeEventListener("keydown", handleKeyPress);
        }, []);

        // Notification system
        const addNotification = (notification) => {
          const id = Date.now();
          setNotifications((prev) => [...prev, { ...notification, id }]);
          setTimeout(() => {
            setNotifications((prev) => prev.filter((n) => n.id !== id));
          }, 5000);
        };

        return React.createElement(
          "div",
          { className: "control-station" },
          React.createElement(WorkflowPanel, {
            collapsed: leftCollapsed,
            onPhaseSelect: handlePhaseSelect,
          }),

          // Show phase interface or deliverables panel
          activePhase
            ? React.createElement(PhaseInterface, {
                phase: activePhase,
                onComplete: handlePhaseComplete,
                onCancel: handlePhaseCancel,
              })
            : React.createElement(DeliverablesPanel, { collapsed: false }),

          React.createElement(LLMChatPanel, { collapsed: rightCollapsed }),

          // Keyboard shortcuts help
          React.createElement(
            "div",
            {
              style: {
                position: "fixed",
                bottom: "10px",
                right: "10px",
                background: "var(--soviet-charcoal)",
                border: "1px solid var(--soviet-brass)",
                padding: "5px 10px",
                borderRadius: "4px",
                fontSize: "11px",
                opacity: 0.7,
              },
            },
            "F1: Toggle Workflow | F3: Toggle Chat"
          ),

          // Notification overlay
          notifications.length > 0 &&
            React.createElement(
              "div",
              {
                style: {
                  position: "fixed",
                  top: "20px",
                  right: "20px",
                  zIndex: 1000,
                },
              },
              notifications.map((notification) =>
                React.createElement(
                  "div",
                  {
                    key: notification.id,
                    style: {
                      background: "var(--soviet-crimson)",
                      color: "white",
                      padding: "10px",
                      margin: "5px 0",
                      borderRadius: "4px",
                      minWidth: "300px",
                    },
                  },
                  notification.message
                )
              )
            )
        );
      };

      // Render the application using React 18 createRoot API
      const rootElement = document.getElementById("root");
      if (!rootElement._reactRoot) {
        const root = ReactDOM.createRoot(rootElement);
        rootElement._reactRoot = root;
        root.render(React.createElement(LawyerFactoryApp));
      } else {
        rootElement._reactRoot.render(React.createElement(LawyerFactoryApp));
      }
    </script>
  </body>
</html>
