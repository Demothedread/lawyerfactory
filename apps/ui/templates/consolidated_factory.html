<!--
LawyerFactory Soviet Control Panel Interface
Industrial control board aesthetic with 3-panel layout for legal workflow automation
Optimized for 1920x1080 displays with collapsible panels for focus mode
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öôÔ∏è LawyerFactory Control Station</title>
    
    <!-- Core Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- React and Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- ag-Grid for Evidence Management -->
    <script src="https://unpkg.com/ag-grid-community@30.2.1/dist/ag-grid-community.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/ag-grid-community@30.2.1/dist/ag-grid-theme-quartz.min.css" />
    
    <!-- Soviet Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;500;700;900&family=Russo+One&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Soviet Control Board Color Palette */
            --soviet-brass: #B87333;
            --soviet-bronze: #CD7F32;
            --soviet-emerald: #00563F;
            --soviet-crimson: #DC143C;
            --soviet-silver: #C0C0C0;
            --soviet-charcoal: #1A1A1A;
            --soviet-steel: #434B4D;
            --soviet-amber: #FFB000;
            --soviet-warning: #FF6B35;
            --soviet-success: #00A878;
            --panel-rivets: #8B8680;
            
            /* Panel Dimensions */
            --panel-left: 400px;
            --panel-center: 920px;
            --panel-right: 600px;
            --panel-header: 80px;
            --panel-collapsed: 48px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Share Tech Mono', 'Russo One', monospace;
            background: linear-gradient(135deg, var(--soviet-charcoal) 0%, var(--soviet-steel) 100%);
            color: var(--soviet-silver);
            overflow: hidden;
            position: relative;
        }
        
        /* Scanline Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.03) 2px,
                rgba(0, 0, 0, 0.03) 4px
            );
            pointer-events: none;
            z-index: 9999;
        }
        
        /* Main Control Panel Container */
        .control-station {
            display: flex;
            height: 100vh;
            position: relative;
            background: radial-gradient(ellipse at center, rgba(184, 115, 51, 0.05) 0%, transparent 70%);
        }
        
        /* Metal Panel Base Style */
        .metal-panel {
            background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 50%, #2a2a2a 100%);
            border: 3px solid var(--soviet-brass);
            position: relative;
            box-shadow:
                inset 0 2px 5px rgba(0,0,0,0.5),
                inset 0 -2px 5px rgba(0,0,0,0.5),
                0 4px 8px rgba(0,0,0,0.8);
        }
        
        /* Rivet Decoration */
        .rivets::before,
        .rivets::after {
            content: '‚¨¢ ‚¨¢ ‚¨¢ ‚¨¢';
            position: absolute;
            color: var(--panel-rivets);
            font-size: 10px;
            letter-spacing: 20px;
            left: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .rivets::before {
            top: 8px;
        }
        
        .rivets::after {
            bottom: 8px;
        }
        
        /* Panel Headers */
        .panel-header {
            height: var(--panel-header);
            background: linear-gradient(180deg, var(--soviet-brass) 0%, var(--soviet-bronze) 100%);
            border-bottom: 3px solid var(--soviet-charcoal);
            display: flex;
            align-items: center;
            padding: 0 20px;
            position: relative;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            color: var(--soviet-charcoal);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        /* Warning Stripes */
        .warning-stripe {
            height: 8px;
            background: repeating-linear-gradient(
                45deg,
                var(--soviet-amber),
                var(--soviet-amber) 10px,
                var(--soviet-charcoal) 10px,
                var(--soviet-charcoal) 20px
            );
        }
        
        /* Analog Gauge Component */
        .analog-gauge {
            width: 120px;
            height: 120px;
            position: relative;
            background: radial-gradient(circle at center, #1a1a1a 0%, #0f0f0f 100%);
            border: 3px solid var(--soviet-brass);
            border-radius: 50%;
            box-shadow:
                inset 0 0 20px rgba(0,0,0,0.8),
                0 2px 10px rgba(0,0,0,0.5);
        }
        
        .gauge-needle {
            position: absolute;
            width: 2px;
            height: 45px;
            background: var(--soviet-crimson);
            left: 50%;
            top: 15%;
            transform-origin: center bottom;
            transform: translateX(-50%) rotate(0deg);
            transition: transform 0.3s ease-out;
            box-shadow: 0 0 4px var(--soviet-crimson);
        }
        
        .gauge-center {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--soviet-brass);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
        }
        
        /* Toggle Switch Component */
        .toggle-switch {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background: var(--soviet-charcoal);
            border: 2px solid var(--soviet-brass);
            border-radius: 4px;
        }
        
        .toggle-track {
            width: 60px;
            height: 30px;
            background: linear-gradient(180deg, #0f0f0f 0%, #2a2a2a 100%);
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.8);
        }
        
        .toggle-handle {
            width: 26px;
            height: 26px;
            background: linear-gradient(135deg, var(--soviet-brass) 0%, var(--soviet-bronze) 100%);
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .toggle-switch.active .toggle-handle {
            transform: translateX(30px);
        }
        
        .led-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--soviet-crimson);
            box-shadow: 0 0 8px var(--soviet-crimson);
            opacity: 0.3;
            transition: opacity 0.2s ease;
        }
        
        .toggle-switch.active .led-indicator {
            background: var(--soviet-success);
            box-shadow: 0 0 12px var(--soviet-success);
            opacity: 1;
        }
        
        /* Nixie Tube Display */
        .nixie-display {
            display: inline-block;
            padding: 10px 15px;
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
            border: 2px solid var(--soviet-brass);
            border-radius: 6px;
            font-family: 'Orbitron', monospace;
            font-size: 28px;
            font-weight: 900;
            color: var(--soviet-amber);
            text-shadow: 0 0 10px var(--soviet-amber);
            box-shadow:
                inset 0 0 20px rgba(255, 176, 0, 0.2),
                0 2px 10px rgba(0,0,0,0.8);
        }
        
        /* Mechanical Button */
        .mech-button {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--soviet-brass) 0%, var(--soviet-bronze) 50%, var(--soviet-brass) 100%);
            border: 3px solid var(--soviet-charcoal);
            border-radius: 6px;
            font-family: 'Russo One', sans-serif;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--soviet-charcoal);
            cursor: pointer;
            position: relative;
            transition: all 0.1s ease;
            box-shadow:
                0 4px 0 var(--soviet-charcoal),
                0 6px 8px rgba(0,0,0,0.5);
        }
        
        .mech-button:active {
            transform: translateY(4px);
            box-shadow:
                0 0 0 var(--soviet-charcoal),
                0 2px 4px rgba(0,0,0,0.5);
        }
        
        .mech-button.danger {
            background: linear-gradient(135deg, var(--soviet-crimson) 0%, #B91C1C 50%, var(--soviet-crimson) 100%);
            color: white;
        }
        
        .mech-button.success {
            background: linear-gradient(135deg, var(--soviet-emerald) 0%, #00A878 50%, var(--soviet-emerald) 100%);
            color: white;
        }
        
        /* Status Light Array */
        .status-lights {
            display: flex;
            gap: 8px;
            padding: 10px;
            background: var(--soviet-charcoal);
            border: 2px solid var(--soviet-steel);
            border-radius: 4px;
        }
        
        .status-light {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--soviet-steel);
            position: relative;
            transition: all 0.3s ease;
        }
        
        .status-light.green {
            background: var(--soviet-success);
            box-shadow: 0 0 10px var(--soviet-success);
        }
        
        .status-light.amber {
            background: var(--soviet-amber);
            box-shadow: 0 0 10px var(--soviet-amber);
            animation: pulse 1s infinite;
        }
        
        .status-light.red {
            background: var(--soviet-crimson);
            box-shadow: 0 0 10px var(--soviet-crimson);
            animation: blink 0.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.3; }
        }
        
        /* Panel Layouts */
        .panel-left {
            width: var(--panel-left);
            transition: width 0.3s ease;
            border-right: 3px solid var(--soviet-brass);
        }
        
        .panel-center {
            flex: 1;
            min-width: var(--panel-center);
        }
        
        .panel-right {
            width: var(--panel-right);
            transition: width 0.3s ease;
            border-left: 3px solid var(--soviet-brass);
        }
        
        .panel-collapsed {
            width: var(--panel-collapsed) !important;
        }
        
        .panel-content {
            padding: 20px;
            height: calc(100vh - var(--panel-header));
            overflow-y: auto;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--soviet-charcoal);
            border: 1px solid var(--soviet-steel);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--soviet-brass);
            border-radius: 2px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--soviet-bronze);
        }
        
        /* Soviet Grid Theme Override */
        .ag-theme-soviet {
            --ag-background-color: var(--soviet-charcoal);
            --ag-header-background-color: var(--soviet-steel);
            --ag-header-foreground-color: var(--soviet-silver);
            --ag-border-color: var(--soviet-brass);
            --ag-row-hover-color: rgba(184, 115, 51, 0.1);
            --ag-selected-row-background-color: rgba(0, 86, 63, 0.2);
        }
        
        /* Chat Interface */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .chat-message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .agent-avatar {
            width: 48px;
            height: 48px;
            background: var(--soviet-brass);
            border: 2px solid var(--soviet-charcoal);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .message-content {
            flex: 1;
            padding: 12px;
            background: rgba(43, 75, 77, 0.3);
            border: 1px solid var(--soviet-steel);
            border-radius: 6px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .chat-input {
            padding: 20px;
            border-top: 2px solid var(--soviet-brass);
            background: var(--soviet-charcoal);
        }
        
        .input-field {
            width: 100%;
            padding: 12px;
            background: var(--soviet-steel);
            border: 2px solid var(--soviet-brass);
            border-radius: 4px;
            color: var(--soviet-silver);
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--soviet-amber);
            box-shadow: 0 0 10px rgba(255, 176, 0, 0.3);
        }
    </style>
  </head>

    <body>
        <div id="root"></div>
        
        <script type="text/babel">
            const { useState, useEffect, useRef, useCallback } = React;
            
            // Phase Configuration
            const PHASES = [
                {
                    id: "A01",
                    name: "Document Intake",
                    description: "Upload and categorize legal documents",
                    type: "preproduction",
                    icon: "üìÑ",
                    inputs: ["Legal documents", "Client information", "Case details"],
                    outputs: ["Categorized documents", "Extracted facts", "Evidence table"],
                },
                {
                    id: "A02",
                    name: "Legal Research",
                    description: "Automated legal research and authority gathering",
                    type: "preproduction",
                    icon: "üîç",
                    inputs: ["Case facts", "Jurisdiction", "Legal issues"],
                    outputs: ["Legal authorities", "Precedent cases", "Research notes"],
                },
                {
                    id: "A03",
                    name: "Case Outline",
                    description: "Structure case claims and arguments",
                    type: "preproduction",
                    icon: "üìã",
                    inputs: ["Research results", "Evidence", "Legal theories"],
                    outputs: ["Case outline", "Claims matrix", "Argument structure"],
                },
                {
                    id: "B01",
                    name: "Quality Review",
                    description: "Validate research and outline quality",
                    type: "production",
                    icon: "‚úÖ",
                    inputs: ["Case outline", "Research quality", "Evidence strength"],
                    outputs: ["Quality assessment", "Missing elements", "Recommendations"],
                },
                {
                    id: "B02",
                    name: "Document Drafting",
                    description: "Generate professional legal documents",
                    type: "production",
                    icon: "‚úçÔ∏è",
                    inputs: ["Approved outline", "Templates", "Legal standards"],
                    outputs: ["Draft documents", "Legal pleadings", "Supporting briefs"],
                },
                {
                    id: "C01",
                    name: "Document Editing",
                    description: "Refine formatting and citations",
                    type: "production",
                    icon: "üîß",
                    inputs: ["Draft documents", "Citation rules", "Format standards"],
                    outputs: ["Formatted documents", "Proper citations", "Final review"],
                },
                {
                    id: "C02",
                    name: "Final Orchestration",
                    description: "Coordinate and finalize all deliverables",
                    type: "production",
                    icon: "üéØ",
                    inputs: ["All phase outputs", "Quality checks", "Client review"],
                    outputs: ["Court-ready documents", "Filing package", "Case summary"],
                },
            ];
            
            // Soviet Control Panel Components
            const AnalogGauge = ({ value, label, max = 100, color = 'var(--soviet-crimson)' }) => {
                const angle = (value / max) * 180 - 90; // -90 to 90 degrees
                
                return React.createElement('div', { className: 'analog-gauge' },
                    React.createElement('div', {
                        className: 'gauge-needle',
                        style: { transform: `translateX(-50%) rotate(${angle}deg)` }
                    }),
                    React.createElement('div', { className: 'gauge-center' }),
                    React.createElement('div', {
                        style: {
                            position: 'absolute',
                            bottom: '15px',
                            left: '50%',
                            transform: 'translateX(-50%)',
                            fontSize: '12px',
                            fontWeight: 'bold',
                            color: 'var(--soviet-silver)'
                        }
                    }, label)
                );
            };
            
            const ToggleSwitch = ({ active, onToggle, label }) => {
                return React.createElement('div', { className: 'toggle-switch' + (active ? ' active' : '') },
                    React.createElement('span', { style: { fontSize: '12px', color: 'var(--soviet-silver)' } }, label),
                    React.createElement('div', { className: 'toggle-track', onClick: onToggle },
                        React.createElement('div', { className: 'toggle-handle' })
                    ),
                    React.createElement('div', { className: 'led-indicator' })
                );
            };
            
            const NixieDisplay = ({ value, digits = 3 }) => {
                const paddedValue = String(value).padStart(digits, '0');
                return React.createElement('div', { className: 'nixie-display' }, paddedValue);
            };
            
            const MetalPanel = ({ children, title, className = '', collapsed = false }) => {
                return React.createElement('div', {
                    className: `metal-panel rivets ${className}`
                },
                    title && React.createElement('div', { className: 'panel-header' },
                        React.createElement('h3', null, title)
                    ),
                    !collapsed && React.createElement('div', { className: 'panel-content' }, children)
                );
            };
            
            const MechanicalButton = ({ children, onClick, variant = 'default', disabled = false }) => {
                const className = `mech-button ${variant}`;
                return React.createElement('button', {
                    className,
                    onClick,
                    disabled
                }, children);
            };
            
            const StatusLights = ({ statuses }) => {
                return React.createElement('div', { className: 'status-lights' },
                    statuses.map((status, index) =>
                        React.createElement('div', {
                            key: index,
                            className: `status-light ${status}`
                        })
                    )
                );
            };
            
            // Evidence Table Component
            const EvidenceTable = () => {
                const [evidenceData, setEvidenceData] = useState([]);
                const gridRef = useRef(null);
                
                const columnDefs = [
                    { field: 'id', headerName: 'ID', width: 80, pinned: 'left' },
                    { field: 'source', headerName: 'Source', width: 150 },
                    { field: 'content', headerName: 'Content', flex: 1 },
                    { field: 'relevance', headerName: 'Relevance', width: 100 },
                    { field: 'type', headerName: 'Type', width: 120 },
                    { field: 'date', headerName: 'Date', width: 100 }
                ];
                
                useEffect(() => {
                    // Load evidence data
                    fetch('/api/evidence')
                        .then(response => response.json())
                        .then(data => setEvidenceData(data.evidence_entries || []))
                        .catch(error => console.error('Error loading evidence:', error));
                }, []);
                
                return React.createElement('div', {
                    className: 'ag-theme-soviet',
                    style: { height: '400px', width: '100%' }
                },
                    typeof agGrid !== 'undefined' && agGrid.AgGridReact ?
                        React.createElement(agGrid.AgGridReact, {
                            ref: gridRef,
                            columnDefs,
                            rowData: evidenceData,
                            defaultColDef: {
                                sortable: true,
                                filter: true,
                                resizable: true
                            },
                            onGridReady: (params) => {
                                gridRef.current = params.api;
                            }
                        }) :
                        React.createElement('div', {
                            style: {
                                padding: '20px',
                                textAlign: 'center',
                                color: 'var(--soviet-amber)',
                                border: '1px solid var(--soviet-brass)'
                            }
                        }, 'Evidence Table Loading...')
                );
            };
            
            // Claims Matrix Component
            const ClaimsMatrix = () => {
                const [claims, setClaims] = useState([]);
                
                useEffect(() => {
                    // Load claims data
                    fetch('/api/claims')
                        .then(response => response.json())
                        .then(data => setClaims(data.claims || []))
                        .catch(error => console.error('Error loading claims:', error));
                }, []);
                
                return React.createElement('div', { className: 'claims-matrix' },
                    React.createElement('h4', null, 'Claims Matrix'),
                    React.createElement('div', { className: 'matrix-grid' },
                        claims.map((claim, index) =>
                            React.createElement('div', {
                                key: index,
                                className: 'claim-card metal-panel',
                                style: { margin: '10px', padding: '15px' }
                            },
                                React.createElement('h5', null, claim.cause_of_action || 'Claim ' + (index + 1)),
                                React.createElement('div', { className: 'claim-strength' },
                                    React.createElement(AnalogGauge, {
                                        value: claim.claim_strength * 100 || 0,
                                        label: 'Strength',
                                        max: 100
                                    })
                                )
                            )
                        )
                    )
                );
            };
            
            // Shot List Component
            const ShotList = () => {
                const [shots, setShots] = useState([]);
                
                useEffect(() => {
                    // Load shot list data
                    fetch('/api/shotlist')
                        .then(response => response.json())
                        .then(data => setShots(data.shots || []))
                        .catch(error => console.error('Error loading shots:', error));
                }, []);
                
                return React.createElement('div', { className: 'shot-list' },
                    React.createElement('h4', null, 'Document Sequence'),
                    React.createElement('div', { className: 'shot-items' },
                        shots.map((shot, index) =>
                            React.createElement('div', {
                                key: index,
                                className: 'shot-item',
                                style: {
                                    padding: '10px',
                                    margin: '5px 0',
                                    background: 'var(--soviet-steel)',
                                    border: '1px solid var(--soviet-brass)',
                                    borderRadius: '4px'
                                }
                            },
                                React.createElement('div', { style: { fontWeight: 'bold' } },
                                    shot.title || `Shot ${index + 1}`
                                ),
                                React.createElement('div', { style: { fontSize: '12px', opacity: 0.8 } },
                                    shot.description || 'Document preparation step'
                                )
                            )
                        )
                    )
                );
            };
            
            // Chat Interface Component
            const ChatInterface = () => {
                const [messages, setMessages] = useState([]);
                const [inputValue, setInputValue] = useState('');
                const [activeAgent, setActiveAgent] = useState('maestro');
                const messagesEndRef = useRef(null);
                
                const agents = {
                    maestro: { name: 'Maestro', icon: 'üé≠', color: 'var(--soviet-brass)' },
                    reader: { name: 'Reader', icon: 'üìñ', color: 'var(--soviet-emerald)' },
                    researcher: { name: 'Researcher', icon: 'üîç', color: 'var(--soviet-bronze)' },
                    writer: { name: 'Writer', icon: '‚úçÔ∏è', color: 'var(--soviet-amber)' },
                    editor: { name: 'Editor', icon: 'üîß', color: 'var(--soviet-crimson)' }
                };
                
                const scrollToBottom = () => {
                    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
                };
                
                useEffect(scrollToBottom, [messages]);
                
                const handleSendMessage = () => {
                    if (!inputValue.trim()) return;
                    
                    const newMessage = {
                        id: Date.now(),
                        agent: 'user',
                        content: inputValue,
                        timestamp: new Date().toLocaleTimeString()
                    };
                    
                    setMessages(prev => [...prev, newMessage]);
                    setInputValue('');
                    
                    // Simulate agent response
                    setTimeout(() => {
                        const response = {
                            id: Date.now() + 1,
                            agent: activeAgent,
                            content: `${agents[activeAgent].name} acknowledges: "${inputValue}". Processing request...`,
                            timestamp: new Date().toLocaleTimeString()
                        };
                        setMessages(prev => [...prev, response]);
                    }, 1000);
                };
                
                const handleKeyPress = (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        handleSendMessage();
                    }
                };
                
                return React.createElement('div', { className: 'chat-container' },
                    React.createElement('div', { className: 'chat-messages' },
                        messages.map(message =>
                            React.createElement('div', {
                                key: message.id,
                                className: 'chat-message'
                            },
                                React.createElement('div', {
                                    className: 'agent-avatar',
                                    style: {
                                        background: message.agent === 'user' ? 'var(--soviet-steel)' : agents[message.agent]?.color
                                    }
                                }, message.agent === 'user' ? 'üë§' : agents[message.agent]?.icon),
                                React.createElement('div', { className: 'message-content' },
                                    React.createElement('div', {
                                        style: { fontSize: '12px', opacity: 0.7, marginBottom: '5px' }
                                    }, `${message.agent === 'user' ? 'You' : agents[message.agent]?.name} - ${message.timestamp}`),
                                    message.content
                                )
                            )
                        ),
                        React.createElement('div', { ref: messagesEndRef })
                    ),
                    React.createElement('div', { className: 'chat-input' },
                        React.createElement('div', { style: { marginBottom: '10px' } },
                            React.createElement('label', { style: { fontSize: '12px', marginRight: '10px' } }, 'Active Agent:'),
                            React.createElement('select', {
                                value: activeAgent,
                                onChange: (e) => setActiveAgent(e.target.value),
                                style: {
                                    background: 'var(--soviet-steel)',
                                    border: '1px solid var(--soviet-brass)',
                                    color: 'var(--soviet-silver)',
                                    padding: '5px'
                                }
                            },
                                Object.entries(agents).map(([key, agent]) =>
                                    React.createElement('option', { key, value: key },
                                        `${agent.icon} ${agent.name}`
                                    )
                                )
                            )
                        ),
                        React.createElement('div', { style: { display: 'flex', gap: '10px' } },
                            React.createElement('input', {
                                type: 'text',
                                className: 'input-field',
                                value: inputValue,
                                onChange: (e) => setInputValue(e.target.value),
                                onKeyPress: handleKeyPress,
                                placeholder: `Message ${agents[activeAgent].name}...`,
                                style: { flex: 1 }
                            }),
                            React.createElement(MechanicalButton, {
                                onClick: handleSendMessage,
                                variant: 'success'
                            }, 'Send')
                        )
                    )
                );
            };
            
            // Workflow Panel Component
            const WorkflowPanel = ({ collapsed }) => {
                const [activePhase, setActivePhase] = useState(null);
                const [completedPhases, setCompletedPhases] = useState(new Set());
                const [phaseProgress, setPhaseProgress] = useState({});
                
                const handlePhaseStart = (phaseId) => {
                    setActivePhase(phaseId);
                    // Emit to backend via Socket.IO
                    // socketRef.current?.emit('start_phase', { phase: phaseId });
                };
                
                const handlePhaseComplete = (phaseId) => {
                    setCompletedPhases(prev => new Set([...prev, phaseId]));
                    setActivePhase(null);
                };
                
                const getPhaseStatus = (phase) => {
                    if (completedPhases.has(phase.id)) return 'completed';
                    if (activePhase === phase.id) return 'active';
                    return 'pending';
                };
                
                if (collapsed) {
                    return React.createElement(MetalPanel, {
                        title: 'WF',
                        collapsed: true,
                        className: 'panel-left panel-collapsed'
                    });
                }
                
                return React.createElement(MetalPanel, {
                    title: 'Workflow Control',
                    className: 'panel-left'
                },
                    React.createElement('div', { style: { marginBottom: '20px' } },
                        React.createElement('h4', null, 'System Status'),
                        React.createElement(StatusLights, {
                            statuses: ['green', 'green', 'amber', 'red', 'red']
                        })
                    ),
                    
                    React.createElement('div', { style: { marginBottom: '20px' } },
                        React.createElement('h4', null, 'Progress Metrics'),
                        React.createElement(AnalogGauge, {
                            value: (completedPhases.size / PHASES.length) * 100,
                            label: 'Overall',
                            max: 100
                        }),
                        React.createElement(NixieDisplay, {
                            value: completedPhases.size,
                            digits: 1
                        }),
                        React.createElement('span', { style: { marginLeft: '10px', fontSize: '12px' } },
                            `/ ${PHASES.length} Phases`
                        )
                    ),
                    
                    React.createElement('div', { className: 'workflow-phases' },
                        React.createElement('h4', null, 'Phase Control'),
                        PHASES.map(phase => {
                            const status = getPhaseStatus(phase);
                            return React.createElement('div', {
                                key: phase.id,
                                style: {
                                    margin: '10px 0',
                                    padding: '10px',
                                    background: status === 'active' ? 'rgba(255, 176, 0, 0.1)' :
                                              status === 'completed' ? 'rgba(0, 168, 120, 0.1)' :
                                              'var(--soviet-steel)',
                                    border: '1px solid var(--soviet-brass)',
                                    borderRadius: '4px'
                                }
                            },
                                React.createElement('div', {
                                    style: {
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        marginBottom: '5px'
                                    }
                                },
                                    React.createElement('span', { style: { fontWeight: 'bold' } },
                                        `${phase.icon} ${phase.id}`
                                    ),
                                    React.createElement('div', { className: `status-light ${
                                        status === 'completed' ? 'green' :
                                        status === 'active' ? 'amber' : ''
                                    }` })
                                ),
                                React.createElement('div', { style: { fontSize: '12px', marginBottom: '5px' } },
                                    phase.name
                                ),
                                status === 'pending' && React.createElement(MechanicalButton, {
                                    onClick: () => handlePhaseStart(phase.id),
                                    variant: 'default'
                                }, 'Start'),
                                status === 'active' && React.createElement(MechanicalButton, {
                                    onClick: () => handlePhaseComplete(phase.id),
                                    variant: 'success'
                                }, 'Complete')
                            );
                        })
                    )
                );
            };
            
            // Deliverables Panel Component
            const DeliverablesPanel = ({ collapsed }) => {
                const [activeTab, setActiveTab] = useState('evidence');
                
                if (collapsed) {
                    return React.createElement(MetalPanel, {
                        title: 'DEL',
                        collapsed: true,
                        className: 'panel-center panel-collapsed'
                    });
                }
                
                return React.createElement(MetalPanel, {
                    title: 'Deliverables & Data',
                    className: 'panel-center'
                },
                    React.createElement('div', { className: 'warning-stripe' }),
                    
                    React.createElement('div', { style: { display: 'flex', gap: '10px', marginBottom: '20px' } },
                        React.createElement(ToggleSwitch, {
                            active: activeTab === 'evidence',
                            onToggle: () => setActiveTab('evidence'),
                            label: 'Evidence'
                        }),
                        React.createElement(ToggleSwitch, {
                            active: activeTab === 'claims',
                            onToggle: () => setActiveTab('claims'),
                            label: 'Claims'
                        }),
                        React.createElement(ToggleSwitch, {
                            active: activeTab === 'sequence',
                            onToggle: () => setActiveTab('sequence'),
                            label: 'Sequence'
                        })
                    ),
                    
                    activeTab === 'evidence' && React.createElement(EvidenceTable),
                    activeTab === 'claims' && React.createElement(ClaimsMatrix),
                    activeTab === 'sequence' && React.createElement(ShotList)
                );
            };
            
            // LLM Chat Panel Component
            const LLMChatPanel = ({ collapsed }) => {
                if (collapsed) {
                    return React.createElement(MetalPanel, {
                        title: 'LLM',
                        collapsed: true,
                        className: 'panel-right panel-collapsed'
                    });
                }
                
                return React.createElement(MetalPanel, {
                    title: 'Agent Communication',
                    className: 'panel-right'
                },
                    React.createElement(ChatInterface)
                );
            };
            
            // Main Application Component
            const LawyerFactoryApp = () => {
                const [leftCollapsed, setLeftCollapsed] = useState(false);
                const [rightCollapsed, setRightCollapsed] = useState(false);
                const [notifications, setNotifications] = useState([]);
                
                // Keyboard shortcuts
                useEffect(() => {
                    const handleKeyPress = (e) => {
                        if (e.key === 'F1') {
                            e.preventDefault();
                            setLeftCollapsed(prev => !prev);
                        } else if (e.key === 'F3') {
                            e.preventDefault();
                            setRightCollapsed(prev => !prev);
                        }
                    };
                    
                    window.addEventListener('keydown', handleKeyPress);
                    return () => window.removeEventListener('keydown', handleKeyPress);
                }, []);
                
                // Notification system
                const addNotification = (notification) => {
                    const id = Date.now();
                    setNotifications(prev => [...prev, { ...notification, id }]);
                    setTimeout(() => {
                        setNotifications(prev => prev.filter(n => n.id !== id));
                    }, 5000);
                };
                
                return React.createElement('div', { className: 'control-station' },
                    React.createElement(WorkflowPanel, { collapsed: leftCollapsed }),
                    React.createElement(DeliverablesPanel, { collapsed: false }),
                    React.createElement(LLMChatPanel, { collapsed: rightCollapsed }),
                    
                    // Keyboard shortcuts help
                    React.createElement('div', {
                        style: {
                            position: 'fixed',
                            bottom: '10px',
                            right: '10px',
                            background: 'var(--soviet-charcoal)',
                            border: '1px solid var(--soviet-brass)',
                            padding: '5px 10px',
                            borderRadius: '4px',
                            fontSize: '11px',
                            opacity: 0.7
                        }
                    }, 'F1: Toggle Workflow | F3: Toggle Chat'),
                    
                    // Notification overlay
                    notifications.length > 0 && React.createElement('div', {
                        style: {
                            position: 'fixed',
                            top: '20px',
                            right: '20px',
                            zIndex: 1000
                        }
                    },
                        notifications.map(notification =>
                            React.createElement('div', {
                                key: notification.id,
                                style: {
                                    background: 'var(--soviet-crimson)',
                                    color: 'white',
                                    padding: '10px',
                                    margin: '5px 0',
                                    borderRadius: '4px',
                                    minWidth: '300px'
                                }
                            }, notification.message)
                        )
                    )
                );
            };
            
            // Render the application using React 18 createRoot API
            const rootElement = document.getElementById('root');
            if (!rootElement._reactRoot) {
                const root = ReactDOM.createRoot(rootElement);
                rootElement._reactRoot = root;
                root.render(React.createElement(LawyerFactoryApp));
            } else {
                rootElement._reactRoot.render(React.createElement(LawyerFactoryApp));
            }
        </script>
    </body>
</html>
